<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 1 How to Outsmart a Nobel Laureate | Empirical Research Methods</title>
  <meta name="description" content="Lesson 1 How to Outsmart a Nobel Laureate | Empirical Research Methods" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 1 How to Outsmart a Nobel Laureate | Empirical Research Methods" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 1 How to Outsmart a Nobel Laureate | Empirical Research Methods" />
  
  
  

<meta name="author" content="Francis J. DiTraglia" />


<meta name="date" content="2022-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="using-webexercises.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/core-erm-logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisites"><i class="fa fa-check"></i>Pre-requisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-not-stata"><i class="fa fa-check"></i>Why not Stata?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-not-matlab-julia-or-python"><i class="fa fa-check"></i>Why not Matlab, Julia, or Python?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="how-to-outsmart-a-nobel-laureate.html"><a href="how-to-outsmart-a-nobel-laureate.html"><i class="fa fa-check"></i><b>1</b> How to Outsmart a Nobel Laureate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="how-to-outsmart-a-nobel-laureate.html"><a href="how-to-outsmart-a-nobel-laureate.html#the-hot-hand"><i class="fa fa-check"></i><b>1.1</b> The Hot Hand</a></li>
<li class="chapter" data-level="1.2" data-path="how-to-outsmart-a-nobel-laureate.html"><a href="how-to-outsmart-a-nobel-laureate.html#hidden-solutions-and-hints"><i class="fa fa-check"></i><b>1.2</b> Hidden solutions and hints</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="how-to-outsmart-a-nobel-laureate.html"><a href="how-to-outsmart-a-nobel-laureate.html#example-problem"><i class="fa fa-check"></i><b>1.2.1</b> Example problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-webexercises.html"><a href="using-webexercises.html"><i class="fa fa-check"></i><b>2</b> Using <code>webexercises</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-webexercises.html"><a href="using-webexercises.html#tally-the-number-of-correct-answers-total_correct"><i class="fa fa-check"></i><b>2.1</b> Tally the number of correct answers: <code>total_correct()</code></a></li>
<li class="chapter" data-level="2.2" data-path="using-webexercises.html"><a href="using-webexercises.html#create-a-truefalse-question-torf"><i class="fa fa-check"></i><b>2.2</b> Create a TRUE/FALSE question: <code>torf()</code></a></li>
<li class="chapter" data-level="2.3" data-path="using-webexercises.html"><a href="using-webexercises.html#create-fill-in-the-blank-questions-fitb"><i class="fa fa-check"></i><b>2.3</b> Create fill-in-the-blank Questions: <code>fitb()</code></a></li>
<li class="chapter" data-level="2.4" data-path="using-webexercises.html"><a href="using-webexercises.html#create-a-multiple-choice-question-mcq-mcqlong"><i class="fa fa-check"></i><b>2.4</b> Create a multiple choice question: <code>mcq(), mcqlong()</code></a></li>
<li class="chapter" data-level="2.5" data-path="using-webexercises.html"><a href="using-webexercises.html#hide-solutions-create-hints"><i class="fa fa-check"></i><b>2.5</b> Hide Solutions / Create Hints</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="using-webexercises.html"><a href="using-webexercises.html#example-1-inline-hint-and-solution"><i class="fa fa-check"></i><b>2.5.1</b> Example 1: Inline Hint and Solution</a></li>
<li class="chapter" data-level="2.5.2" data-path="using-webexercises.html"><a href="using-webexercises.html#example-2-chunk-solution-that-doesnt-execute"><i class="fa fa-check"></i><b>2.5.2</b> Example 2: Chunk solution that doesn't execute</a></li>
<li class="chapter" data-level="2.5.3" data-path="using-webexercises.html"><a href="using-webexercises.html#example-3-chunk-solution-that-evaluates"><i class="fa fa-check"></i><b>2.5.3</b> Example 3: Chunk solution that evaluates</a></li>
<li class="chapter" data-level="2.5.4" data-path="using-webexercises.html"><a href="using-webexercises.html#example-4-show-the-output-hide-the-code"><i class="fa fa-check"></i><b>2.5.4</b> Example 4: Show the output, hide the code</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Empirical Research Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="how-to-outsmart-a-nobel-laureate" class="section level1" number="1">
<h1><span class="header-section-number">Lesson 1</span> How to Outsmart a Nobel Laureate</h1>
<div id="the-hot-hand" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> The Hot Hand</h2>
<blockquote>
<p>Amos [Tversky] and his students Tom Gilovich and Robert Vallone caused a stir with their study of misperceptions of randomness in basketball. The "fact" that players occasionally acquire a hot hand is generally accepted by players, coaches, and fans. The inference is irresistible: a player sinks three or four baskets in a row and you cannot help forming the causal judgment that this player is now hot, with a temporarily increased propensity to score. Players on both teams adapt to this judgmentâ€”teammates are more likely to pass to the hot scorer and the defense is more likely to doubleteam. Analysis of thousands of sequences of shots led to a disappointing conclusion: there is no such thing as a hot hand in professional basketball, either in shooting from the field or scoring from the foul line. Of course, some players are more accurate than others, but the sequence of successes and missed shots satisfies all tests of randomness. The hot hand is entirely in the eye of the beholders, who are consistently too quick to perceive order and causality in randomness. The hot hand is a massive and widespread cognitive illusion.</p>
</blockquote>
<ul>
<li>Explain idea behind hot hand: more likely to make a basket if you've just made one.</li>
<li>Sport fans and commentators long claimed this existed; Kahneman et al said it's an illusion; lots of papers on this; add some quotes</li>
<li>In this case the academics turned out to be wrong: Miller &amp; Sanjurjo (2018) showed that the statistical methods researchers had used to study the hot hand were flawed.</li>
<li>Biased <em>against</em> finding evidence of a hot hand even if it exists. Turns out that <em>there is</em> a hot hand phenonmenon.</li>
<li>Here's what I find interesting about this.</li>
<li>Viewed from one perspective, this is a very subtle error: the probabilistic intuition behind it is relatively complicated, M&amp;S even wrote a simpler follow-up paper to try to get the intuition across. Subtle enough to be missed by Nobel laureates!</li>
<li>On the other hand, this is a boneheaded error: anyone with a rudimentary knowledge of programming could have coded up a simulation in under an hour to reveal the problem. No one bothered until M&amp;S.</li>
<li>The moral: simulation is a <em>superpower</em>. It's not a replacement for theory, but a potent complement. If you find a pattern you don't understand in a simulation, this can spur you to try to understand the mathematics behind it.</li>
<li>Swiss Army Knife metaphor: simulation is like the knife, arguably the most important tool in the box, weapon in the arsenal.</li>
<li>Today you'll carry out a simulation establishing the bias of methods previously used to look for a hot hand.</li>
<li>Along the way, you'll learn some helpful tools for simulation more broadly and a useful pattern for keeping your simulation code organized.</li>
<li>Maybe even a touch of parallel computing!</li>
</ul>
<ol style="list-style-type: decimal">
<li>Some basic simulation commands in R: <code>sample()</code>, <code>rbinom()</code>, <code>rnorm()</code>, etc. Read the help files.</li>
<li>Write a function <code>draw_sim_data()</code> that makes 100 Bernoulli(1/2) draws. Optional arguments <code>p</code> and <code>n</code>? This simulates data when there is <em>no hot hand</em></li>
<li><code>set.seed()</code> what does it do?</li>
<li>Think about how to calculate the estimator: fraction of times that three ones are followed by another one compared to another zero. Suppose you had a function <code>is_after_3_ones()</code> that took a vector of 0 and 1 and returned, for each element, whether it is after three ones. How would you use it? Write this function.</li>
<li>Put everything together with <code>replicate()</code> to do a simple sim for <span class="math inline">\(p=1/2\)</span> and <span class="math inline">\(n = 100\)</span>.</li>
<li>How about trying different values of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>? Need to keep results organized: <code>apply()</code> family of functions (or maybe the tidy equivalents?)</li>
<li>Try doing it in parallel with <code>mclapply()</code>. First explain the basic idea of parallel and why this is "embarrassingly parallel." Show them how to time the code, illustrate with <code>sys.sleep()</code>.</li>
<li>For the students who finish very quickly, have some extensions: a markov chain DGP, and <code>is_after_k_ones()</code></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-1" aria-hidden="true" tabindex="-1"></a>dgp <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">p =</span> <span class="fl">0.5</span>) {</span>
<span id="cb1-2"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb1-3"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Maybe have a challenge to write the version for after k ones, but start by</span></span>
<span id="cb1-6"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># asking them to do the one for after 3 ones</span></span>
<span id="cb1-7"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-7" aria-hidden="true" tabindex="-1"></a>is_after_k_ones <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb1-8"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>)</span>
<span id="cb1-9"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb1-10"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-10" aria-hidden="true" tabindex="-1"></a>    out[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x[(i <span class="sc">-</span> k)<span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)]) <span class="sc">==</span> k</span>
<span id="cb1-11"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-12"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb1-13"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-15" aria-hidden="true" tabindex="-1"></a>get_est <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-16"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ones &lt;- which(x == 1)</span></span>
<span id="cb1-17"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mean(x[ones + 1], na.rm = TRUE)</span></span>
<span id="cb1-18"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x[<span class="fu">is_after_k_ones</span>(x, <span class="dv">3</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-19"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-20"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-21" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb1-22"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-23"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-23" aria-hidden="true" tabindex="-1"></a>sim_results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_reps, <span class="fu">get_est</span>(<span class="fu">dgp</span>()))</span>
<span id="cb1-24"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-25"><a href="how-to-outsmart-a-nobel-laureate.html#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(sim_results)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 30 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="erm-book_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="how-to-outsmart-a-nobel-laureate.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sim_results, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.4602045</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ones &lt;- which(x == 1)</span></span>
<span id="cb6-2"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x[which(x == 1) + 1]</span></span>
<span id="cb6-3"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#runs &lt;- rle(x)</span></span>
<span id="cb6-4"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#foo &lt;- rle(x)</span></span>
<span id="cb6-5"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#str(foo)</span></span>
<span id="cb6-6"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#x</span></span>
<span id="cb6-7"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#foo$lengths</span></span>
<span id="cb6-8"><a href="how-to-outsmart-a-nobel-laureate.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#foo$values</span></span></code></pre></div>
</div>
<div id="hidden-solutions-and-hints" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Hidden solutions and hints</h2>
<p>You can fence off a solution area that will be hidden behind a button using <code>hide()</code> before the solution and <code>unhide()</code> after, each as inline R code. Pass the text you want to appear on the button to the <code>hide()</code> function.</p>
<p>If the solution is an RMarkdown code chunk, instead of using <code>hide()</code> and <code>unhide()</code>, simply set the <code>webex.hide</code> chunk option to TRUE, or set it to the string you wish to display on the button.</p>
<div id="example-problem" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Example problem</h3>
<p><strong>Recreate the scatterplot below, using the built-in <code>cars</code> dataset.</strong></p>
<p><img src="erm-book_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="webex-solution">
<button>
I need a hint
</button>
<p>See the documentation for <code>plot()</code> (<code>?plot</code>)</p>
</div>
<!-- note: you could also just set webex.hide to TRUE -->
<div class="webex-solution">
<button>
Click here to see the solution
</button>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="how-to-outsmart-a-nobel-laureate.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>dist)</span></code></pre></div>
</div>
<!-- TO CHANGE WIDGET COLOURS:
  move command below out of this HTML comment area
  and then re-compile;
  unfilled becomes yellow, correct becomes pink 
     

<style>
    .webex-solveme { border-color: #FFFF00; }
    .webex-solveme.webex-correct { border-color: #FF3399; }
</style>


-->

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-webexercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
