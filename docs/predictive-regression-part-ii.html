<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 4 Predictive Regression Part II | Empirical Research Methods</title>
  <meta name="description" content="Lesson 4 Predictive Regression Part II | Empirical Research Methods" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 4 Predictive Regression Part II | Empirical Research Methods" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 4 Predictive Regression Part II | Empirical Research Methods" />
  
  
  

<meta name="author" content="Francis J. DiTraglia" />


<meta name="date" content="2022-06-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="predictive-regression-part-i.html"/>
<link rel="next" href="running-a-simulation-study.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/core-erm-logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisites"><i class="fa fa-check"></i>Pre-requisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#good-coding-style"><i class="fa fa-check"></i>Good Coding Style</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-markdown"><i class="fa fa-check"></i>R Markdown</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-not-stata"><i class="fa fa-check"></i>Why not Stata?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-not-matlab-julia-or-python"><i class="fa fa-check"></i>Why not Matlab, Julia, or Python?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-help-make-this-book-better"><i class="fa fa-check"></i>You can help make this book better!</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html"><i class="fa fa-check"></i><b>1</b> Getting Started with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#package-installation"><i class="fa fa-check"></i><b>1.1</b> Package Installation</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise"><i class="fa fa-check"></i><b>1.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#what-is-a-tibble"><i class="fa fa-check"></i><b>1.2</b> What is a tibble?</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>1.3</b> Filter Rows with <code>filter</code></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercises"><i class="fa fa-check"></i><b>1.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#sort-data-with-arrange"><i class="fa fa-check"></i><b>1.4</b> Sort data with <code>arrange</code></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercises-1"><i class="fa fa-check"></i><b>1.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#choose-columns-with-select"><i class="fa fa-check"></i><b>1.5</b> Choose columns with <code>select</code></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-1"><i class="fa fa-check"></i><b>1.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#the-summarize-verb"><i class="fa fa-check"></i><b>1.6</b> The <code>summarize</code> verb</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-2"><i class="fa fa-check"></i><b>1.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#the-group_by-verb"><i class="fa fa-check"></i><b>1.7</b> The <code>group_by</code> verb</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-3"><i class="fa fa-check"></i><b>1.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#understanding-the-pipe"><i class="fa fa-check"></i><b>1.8</b> Understanding the pipe: <code>%&gt;%</code></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-4"><i class="fa fa-check"></i><b>1.8.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#chaining-commands"><i class="fa fa-check"></i><b>1.9</b> Chaining commands</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-5"><i class="fa fa-check"></i><b>1.9.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#change-an-existing-variable-or-create-a-new-one-with-mutate"><i class="fa fa-check"></i><b>1.10</b> Change an existing variable or create a new one with <code>mutate</code></a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="getting-started-with-dplyr.html"><a href="getting-started-with-dplyr.html#exercise-6"><i class="fa fa-check"></i><b>1.10.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Getting Started with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#a-simple-scatterplot-using-ggplot2"><i class="fa fa-check"></i><b>2.1</b> A simple scatterplot using <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-7"><i class="fa fa-check"></i><b>2.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#plotting-on-the-log-scale"><i class="fa fa-check"></i><b>2.2</b> Plotting on the log scale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-8"><i class="fa fa-check"></i><b>2.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#the-color-and-size-aesthetics"><i class="fa fa-check"></i><b>2.3</b> The color and size aesthetics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-9"><i class="fa fa-check"></i><b>2.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#faceting---plots-for-multiple-subsets"><i class="fa fa-check"></i><b>2.4</b> Faceting - Plots for Multiple Subsets</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-10"><i class="fa fa-check"></i><b>2.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#plotting-summarized-data"><i class="fa fa-check"></i><b>2.5</b> Plotting summarized data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-11"><i class="fa fa-check"></i><b>2.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#line-plots"><i class="fa fa-check"></i><b>2.6</b> Line plots</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-12"><i class="fa fa-check"></i><b>2.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#bar-plots"><i class="fa fa-check"></i><b>2.7</b> Bar plots</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-13"><i class="fa fa-check"></i><b>2.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#cleveland-dot-charts"><i class="fa fa-check"></i><b>2.8</b> Cleveland Dot Charts</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-14"><i class="fa fa-check"></i><b>2.8.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>2.9</b> Histograms</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-15"><i class="fa fa-check"></i><b>2.9.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>2.10</b> Boxplots</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="getting-started-with-ggplot2.html"><a href="getting-started-with-ggplot2.html#exercise-16"><i class="fa fa-check"></i><b>2.10.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html"><i class="fa fa-check"></i><b>3</b> Predictive Regression Part I</a>
<ul>
<li class="chapter" data-level="3.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-17"><i class="fa fa-check"></i><b>3.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#the-least-squares-problem"><i class="fa fa-check"></i><b>3.2</b> The Least Squares Problem</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-18"><i class="fa fa-check"></i><b>3.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#linear-regression-with-lm"><i class="fa fa-check"></i><b>3.3</b> Linear Regression with <code>lm()</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-19"><i class="fa fa-check"></i><b>3.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#plotting-the-regression-line"><i class="fa fa-check"></i><b>3.4</b> Plotting the Regression Line</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-20"><i class="fa fa-check"></i><b>3.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#getting-more-from-lm"><i class="fa fa-check"></i><b>3.5</b> Getting More from <code>lm()</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-21"><i class="fa fa-check"></i><b>3.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#summarizing-the-ouput-of-lm"><i class="fa fa-check"></i><b>3.6</b> Summarizing The Ouput of <code>lm()</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-22"><i class="fa fa-check"></i><b>3.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#tidying-up-with-broom"><i class="fa fa-check"></i><b>3.7</b> Tidying up with <code>broom</code></a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-23"><i class="fa fa-check"></i><b>3.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#dummy-variables-with-lm"><i class="fa fa-check"></i><b>3.8</b> Dummy Variables with <code>lm()</code></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-24"><i class="fa fa-check"></i><b>3.8.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#fun-with-r-formulas"><i class="fa fa-check"></i><b>3.9</b> Fun with R Formulas</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#everything-else---the-dot-."><i class="fa fa-check"></i><b>3.9.1</b> "Everything Else" - The Dot <code>.</code></a></li>
<li class="chapter" data-level="3.9.2" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#removing-predictors-with--"><i class="fa fa-check"></i><b>3.9.2</b> Removing Predictors with <code>-</code></a></li>
<li class="chapter" data-level="3.9.3" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#the-intercept-1"><i class="fa fa-check"></i><b>3.9.3</b> The Intercept: <code>1</code></a></li>
<li class="chapter" data-level="3.9.4" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-25"><i class="fa fa-check"></i><b>3.9.4</b> Exercise</a></li>
<li class="chapter" data-level="3.9.5" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#transforming-outcomes-and-predictors"><i class="fa fa-check"></i><b>3.9.5</b> Transforming Outcomes and Predictors</a></li>
<li class="chapter" data-level="3.9.6" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#adding-interactions-with-and"><i class="fa fa-check"></i><b>3.9.6</b> Adding Interactions With <code>:</code>, <code>*</code>, and <code>^</code></a></li>
<li class="chapter" data-level="3.9.7" data-path="predictive-regression-part-i.html"><a href="predictive-regression-part-i.html#exercise-26"><i class="fa fa-check"></i><b>3.9.7</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html"><i class="fa fa-check"></i><b>4</b> Predictive Regression Part II</a>
<ul>
<li class="chapter" data-level="4.1" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#regressions-used-below"><i class="fa fa-check"></i><b>4.1</b> Regressions Used Below</a></li>
<li class="chapter" data-level="4.2" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#predicting-new-observations"><i class="fa fa-check"></i><b>4.2</b> Predicting New Observations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#exercise-27"><i class="fa fa-check"></i><b>4.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#testing-a-linear-restriction"><i class="fa fa-check"></i><b>4.3</b> Testing a Linear Restriction</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#exercise-28"><i class="fa fa-check"></i><b>4.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#heteroskedasticity-robust-standard-errors-and-tests"><i class="fa fa-check"></i><b>4.4</b> Heteroskedasticity-Robust Standard Errors and Tests</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#exercise-29"><i class="fa fa-check"></i><b>4.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#publication-quality-tables"><i class="fa fa-check"></i><b>4.5</b> Publication Quality Tables</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#datasummary_skim"><i class="fa fa-check"></i><b>4.5.1</b> <code>datasummary_skim()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#datasummary_balance"><i class="fa fa-check"></i><b>4.5.2</b> <code>datasummary_balance()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#modelsummary"><i class="fa fa-check"></i><b>4.5.3</b> <code>modelsummary()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#robust-standard-errors"><i class="fa fa-check"></i><b>4.5.4</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="4.5.5" data-path="predictive-regression-part-ii.html"><a href="predictive-regression-part-ii.html#exercise-30"><i class="fa fa-check"></i><b>4.5.5</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html"><i class="fa fa-check"></i><b>5</b> Running a Simulation Study</a>
<ul>
<li class="chapter" data-level="5.1" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#is-the-hot-hand-an-illusion"><i class="fa fa-check"></i><b>5.1</b> Is the Hot Hand an Illusion?</a></li>
<li class="chapter" data-level="5.2" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#drawing-random-data-in-r"><i class="fa fa-check"></i><b>5.2</b> Drawing Random Data in R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#sample"><i class="fa fa-check"></i><b>5.2.1</b> <code>sample()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>5.2.2</b> Probability Distributions in R</a></li>
<li class="chapter" data-level="5.2.3" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#set.seed"><i class="fa fa-check"></i><b>5.2.3</b> <code>set.seed()</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#exercises-2"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#the-skeleton-of-a-simulation-study"><i class="fa fa-check"></i><b>5.3</b> The Skeleton of a Simulation Study</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#a-biased-estimator-of-sigma2"><i class="fa fa-check"></i><b>5.3.1</b> A Biased Estimator of <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="5.3.2" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#draw_sim_data"><i class="fa fa-check"></i><b>5.3.2</b> <code>draw_sim_data()</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#get_estimate"><i class="fa fa-check"></i><b>5.3.3</b> <code>get_estimate()</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#get_bias"><i class="fa fa-check"></i><b>5.3.4</b> <code>get_bias()</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#running-the-simulation-study"><i class="fa fa-check"></i><b>5.3.5</b> Running the Simulation Study</a></li>
<li class="chapter" data-level="5.3.6" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#expand.grid-and-map"><i class="fa fa-check"></i><b>5.3.6</b> <code>expand.grid()</code> and <code>Map()</code></a></li>
<li class="chapter" data-level="5.3.7" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#formatting-the-results"><i class="fa fa-check"></i><b>5.3.7</b> Formatting the Results</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="running-a-simulation-study.html"><a href="running-a-simulation-study.html#exercise---the-hot-hand"><i class="fa fa-check"></i><b>5.4</b> Exercise - The Hot Hand</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html"><i class="fa fa-check"></i><b>6</b> Logistic Regression and Friends</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#understanding-the-logistic-regression-model"><i class="fa fa-check"></i><b>6.1</b> Understanding the Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#odds-arent-so-odd"><i class="fa fa-check"></i><b>6.1.1</b> Odds aren't so odd!</a></li>
<li class="chapter" data-level="6.1.2" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-31"><i class="fa fa-check"></i><b>6.1.2</b> Exercise</a></li>
<li class="chapter" data-level="6.1.3" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#interpreting-a-simple-logit-regression-model"><i class="fa fa-check"></i><b>6.1.3</b> Interpreting a Simple Logit Regression Model</a></li>
<li class="chapter" data-level="6.1.4" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-32"><i class="fa fa-check"></i><b>6.1.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#simulating-data-from-a-logistic-regression"><i class="fa fa-check"></i><b>6.2</b> Simulating Data from a Logistic Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-33"><i class="fa fa-check"></i><b>6.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#running-a-logistic-regression-in-r"><i class="fa fa-check"></i><b>6.3</b> Running a Logistic Regression in R</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-34"><i class="fa fa-check"></i><b>6.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#predicted-probabilities-for-logistic-regression"><i class="fa fa-check"></i><b>6.4</b> Predicted Probabilities for Logistic Regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-35"><i class="fa fa-check"></i><b>6.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#plotting-a-logistic-regression"><i class="fa fa-check"></i><b>6.5</b> Plotting a Logistic Regression</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-36"><i class="fa fa-check"></i><b>6.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#probit-regression-and-the-linear-probability-model"><i class="fa fa-check"></i><b>6.6</b> Probit Regression and the Linear Probability Model</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#probit-regression"><i class="fa fa-check"></i><b>6.6.1</b> Probit Regression</a></li>
<li class="chapter" data-level="6.6.2" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#the-linear-probability-model"><i class="fa fa-check"></i><b>6.6.2</b> The Linear Probability Model</a></li>
<li class="chapter" data-level="6.6.3" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-37"><i class="fa fa-check"></i><b>6.6.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#addendum-odds-and-ends-about-risk"><i class="fa fa-check"></i><b>6.7</b> Addendum: Odds and Ends about Risk</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="logistic-regression-and-friends.html"><a href="logistic-regression-and-friends.html#exercise-38"><i class="fa fa-check"></i><b>6.7.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html"><i class="fa fa-check"></i><b>7</b> The Normal Distribution</a>
<ul>
<li class="chapter" data-level="7.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#standard-normals-as-building-blocks"><i class="fa fa-check"></i><b>7.1</b> Standard Normals as Building Blocks</a></li>
<li class="chapter" data-level="7.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#the-one-dimensional-case"><i class="fa fa-check"></i><b>7.2</b> The One-Dimensional Case</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#pnorm"><i class="fa fa-check"></i><b>7.2.1</b> <code>pnorm()</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#dnorm"><i class="fa fa-check"></i><b>7.2.2</b> <code>dnorm()</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#qnorm"><i class="fa fa-check"></i><b>7.2.3</b> <code>qnorm()</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#rnorm"><i class="fa fa-check"></i><b>7.2.4</b> <code>rnorm()</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#pqdrnorm-are-vectorized"><i class="fa fa-check"></i><b>7.2.5</b> <code>p/q/d/rnorm()</code> are Vectorized</a></li>
<li class="chapter" data-level="7.2.6" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#be-careful"><i class="fa fa-check"></i><b>7.2.6</b> Be Careful!</a></li>
<li class="chapter" data-level="7.2.7" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercises-3"><i class="fa fa-check"></i><b>7.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#generating-correlated-normal-rvs"><i class="fa fa-check"></i><b>7.3</b> Generating Correlated Normal RVs</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#start-with-uncorrelated-normal-draws"><i class="fa fa-check"></i><b>7.3.1</b> Start with Uncorrelated Normal Draws</a></li>
<li class="chapter" data-level="7.3.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-39"><i class="fa fa-check"></i><b>7.3.2</b> Exercise</a></li>
<li class="chapter" data-level="7.3.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#add-constants-to-shift-the-means"><i class="fa fa-check"></i><b>7.3.3</b> Add Constants to Shift the Means</a></li>
<li class="chapter" data-level="7.3.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-40"><i class="fa fa-check"></i><b>7.3.4</b> Exercise</a></li>
<li class="chapter" data-level="7.3.5" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#multiply-by-scalars-to-change-the-variance"><i class="fa fa-check"></i><b>7.3.5</b> Multiply by Scalars to Change the Variance</a></li>
<li class="chapter" data-level="7.3.6" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#combine-to-create-correlation"><i class="fa fa-check"></i><b>7.3.6</b> Combine to Create Correlation</a></li>
<li class="chapter" data-level="7.3.7" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-41"><i class="fa fa-check"></i><b>7.3.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#the-cholesky-decomposition"><i class="fa fa-check"></i><b>7.4</b> The Cholesky Decomposition</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#going-backwards"><i class="fa fa-check"></i><b>7.4.1</b> Going Backwards</a></li>
<li class="chapter" data-level="7.4.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-42"><i class="fa fa-check"></i><b>7.4.2</b> Exercise</a></li>
<li class="chapter" data-level="7.4.3" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#whats-the-square-root-of-a-matrix"><i class="fa fa-check"></i><b>7.4.3</b> What's the Square Root of a Matrix?</a></li>
<li class="chapter" data-level="7.4.4" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#exercise-43"><i class="fa fa-check"></i><b>7.4.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#epilogue"><i class="fa fa-check"></i><b>7.5</b> Epilogue</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#affine-transformations-of-a-multivariate-normal"><i class="fa fa-check"></i><b>7.5.1</b> Affine Transformations of a Multivariate Normal</a></li>
<li class="chapter" data-level="7.5.2" data-path="the-normal-distribution.html"><a href="the-normal-distribution.html#conditional-distributions-of-bivariate-normal"><i class="fa fa-check"></i><b>7.5.2</b> Conditional Distributions of Bivariate Normal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="text-data.html"><a href="text-data.html"><i class="fa fa-check"></i><b>8</b> Text Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="text-data.html"><a href="text-data.html#unnest_tokens"><i class="fa fa-check"></i><b>8.1</b> <code>unnest_tokens()</code></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="text-data.html"><a href="text-data.html#exercise-44"><i class="fa fa-check"></i><b>8.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="text-data.html"><a href="text-data.html#stop_words-and-word-clouds"><i class="fa fa-check"></i><b>8.2</b> <code>stop_words</code> and Word Clouds</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="text-data.html"><a href="text-data.html#exercise-45"><i class="fa fa-check"></i><b>8.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="text-data.html"><a href="text-data.html#stemming-and-removing-numbers"><i class="fa fa-check"></i><b>8.3</b> Stemming and Removing Numbers</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="text-data.html"><a href="text-data.html#exercise-46"><i class="fa fa-check"></i><b>8.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="text-data.html"><a href="text-data.html#zipfs-law"><i class="fa fa-check"></i><b>8.4</b> Zipf's Law</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="text-data.html"><a href="text-data.html#exercise-47"><i class="fa fa-check"></i><b>8.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="text-data.html"><a href="text-data.html#bind_tf_idf"><i class="fa fa-check"></i><b>8.5</b> <code>bind_tf_idf()</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="text-data.html"><a href="text-data.html#exercise-48"><i class="fa fa-check"></i><b>8.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="text-data.html"><a href="text-data.html#reading-a-corpus-into-r"><i class="fa fa-check"></i><b>8.6</b> Reading a Corpus into R</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="text-data.html"><a href="text-data.html#exercise-49"><i class="fa fa-check"></i><b>8.6.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-rodeo.html"><a href="data-rodeo.html"><i class="fa fa-check"></i><b>9</b> Data Rodeo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-rodeo.html"><a href="data-rodeo.html#joins"><i class="fa fa-check"></i><b>9.1</b> Joins</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-50"><i class="fa fa-check"></i><b>9.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-rodeo.html"><a href="data-rodeo.html#tidyselect"><i class="fa fa-check"></i><b>9.2</b> <code>tidyselect</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-51"><i class="fa fa-check"></i><b>9.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-rodeo.html"><a href="data-rodeo.html#column-wise-operations-with-across"><i class="fa fa-check"></i><b>9.3</b> Column-wise Operations with <code>across()</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-52"><i class="fa fa-check"></i><b>9.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-rodeo.html"><a href="data-rodeo.html#row-wise-operations"><i class="fa fa-check"></i><b>9.4</b> Row-wise operations</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data-rodeo.html"><a href="data-rodeo.html#rowwise"><i class="fa fa-check"></i><b>9.4.1</b> <code>rowwise()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="data-rodeo.html"><a href="data-rodeo.html#c_across"><i class="fa fa-check"></i><b>9.4.2</b> <code>c_across()</code></a></li>
<li class="chapter" data-level="9.4.3" data-path="data-rodeo.html"><a href="data-rodeo.html#across-as-an-alternative-to-rowwise"><i class="fa fa-check"></i><b>9.4.3</b> <code>across()</code> as an alternative to <code>rowwise()</code></a></li>
<li class="chapter" data-level="9.4.4" data-path="data-rodeo.html"><a href="data-rodeo.html#ungroup"><i class="fa fa-check"></i><b>9.4.4</b> <code>ungroup()</code></a></li>
<li class="chapter" data-level="9.4.5" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-53"><i class="fa fa-check"></i><b>9.4.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="data-rodeo.html"><a href="data-rodeo.html#pivoting-from-wider-to-longer-and-back-again"><i class="fa fa-check"></i><b>9.5</b> Pivoting: From Wider to Longer and Back Again</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="data-rodeo.html"><a href="data-rodeo.html#pivot_longer"><i class="fa fa-check"></i><b>9.5.1</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="9.5.2" data-path="data-rodeo.html"><a href="data-rodeo.html#pivot_wider"><i class="fa fa-check"></i><b>9.5.2</b> <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="9.5.3" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-54"><i class="fa fa-check"></i><b>9.5.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="data-rodeo.html"><a href="data-rodeo.html#put-that-in-your-pipe-and-smoke-it"><i class="fa fa-check"></i><b>9.6</b> Put that in your pipe and smoke it!</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="data-rodeo.html"><a href="data-rodeo.html#to-pipe-or-not-to-pipe"><i class="fa fa-check"></i><b>9.6.1</b> To pipe or not to pipe?</a></li>
<li class="chapter" data-level="9.6.2" data-path="data-rodeo.html"><a href="data-rodeo.html#supplying-an-arbitrary-argument"><i class="fa fa-check"></i><b>9.6.2</b> Supplying an Arbitrary Argument</a></li>
<li class="chapter" data-level="9.6.3" data-path="data-rodeo.html"><a href="data-rodeo.html#the-many-pipes-of-magrittr"><i class="fa fa-check"></i><b>9.6.3</b> The many pipes of <code>magrittr</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="data-rodeo.html"><a href="data-rodeo.html#all-about-that-base-rs-native-pipe"><i class="fa fa-check"></i><b>9.6.4</b> All About that Base: R's "Native" Pipe</a></li>
<li class="chapter" data-level="9.6.5" data-path="data-rodeo.html"><a href="data-rodeo.html#how-does-compare-to-in-ggplot2"><i class="fa fa-check"></i><b>9.6.5</b> How does <code>%&gt;%</code> compare to <code>+</code> in <code>ggplot2</code>?</a></li>
<li class="chapter" data-level="9.6.6" data-path="data-rodeo.html"><a href="data-rodeo.html#exercise-55"><i class="fa fa-check"></i><b>9.6.6</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html"><i class="fa fa-check"></i><b>10</b> Poisson Regression and MLE</a>
<ul>
<li class="chapter" data-level="10.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#the-poisson-distribution"><i class="fa fa-check"></i><b>10.1</b> The Poisson Distribution</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#exercise-56"><i class="fa fa-check"></i><b>10.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#the-poisson-regression-model"><i class="fa fa-check"></i><b>10.2</b> The Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#exercise-57"><i class="fa fa-check"></i><b>10.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#whats-a-link-function"><i class="fa fa-check"></i><b>10.3</b> What's a link function?</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#exercise-58"><i class="fa fa-check"></i><b>10.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#dude-wheres-my-r-squared"><i class="fa fa-check"></i><b>10.4</b> Dude, where's my R-squared?</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#aic-and-bic"><i class="fa fa-check"></i><b>10.4.1</b> AIC and BIC</a></li>
<li class="chapter" data-level="10.4.2" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#deviance-and-null-deviance"><i class="fa fa-check"></i><b>10.4.2</b> Deviance and Null Deviance</a></li>
<li class="chapter" data-level="10.4.3" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#exercises-4"><i class="fa fa-check"></i><b>10.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#roll-your-own-poisson-mle"><i class="fa fa-check"></i><b>10.5</b> Roll Your Own Poisson MLE</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#exercise-59"><i class="fa fa-check"></i><b>10.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="poisson-regression-and-mle.html"><a href="poisson-regression-and-mle.html#bonus-stirlings-approximation"><i class="fa fa-check"></i><b>10.6</b> Bonus: Stirling's Approximation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Empirical Research Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="predictive-regression-part-ii" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Lesson 4</span> Predictive Regression Part II<a href="predictive-regression-part-ii.html#predictive-regression-part-ii" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In our last lesson we covered the basics of predictive linear regression using <code>lm()</code>. We learned how to use formulas to set up different regression models, how to use <code>summary()</code> and <code>broom()</code> to display and format the results, and how to make simple plots of the regression line using <code>ggplot()</code>. We applied these tools to a simple dataset of kids test scores and discussed the correct way to interpret the results. In this lesson we'll complete our discussion of predictive linear regression by answering some frequently asked questions:</p>
<ol style="list-style-type: decimal">
<li>How can I extract predictions from a fitted regression model?</li>
<li>I need to test a linear restriction. Is there a way to do this in R?</li>
<li>What about heteroskedasticity? Can I use R to compute robust standard errors?</li>
<li>Journal articles have beautifully-formatted tables of regression results. How can I make one?</li>
</ol>
<div id="regressions-used-below" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Regressions Used Below<a href="predictive-regression-part-ii.html#regressions-used-below" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At several points in this lesson we'll find it helpful to have a few different sets of regression results at our fingertips, so I'll start by fitting three regressions from our last lesson, using the child test score dataset:</p>
<ul>
<li><code>reg_pooled</code> is a regression of <code>kid_score</code> on <code>mom_iq</code> that <em>pools</em> children whose mothers graduated high school with those whose mothers did not.</li>
<li><code>reg_hs_dummy</code> is a regression of <code>kid_score</code> on <code>mom_iq</code> and <code>mom_hs</code>. Recall that <code>mom_hs</code> is a dummy variable that equals one if a child's mother attended high school.</li>
<li><code>reg_interact</code> is a regression of <code>kid_score</code> on <code>mom_iq</code>, <code>mom_hs</code>, and their interaction.</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="predictive-regression-part-ii.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb265-2"><a href="predictive-regression-part-ii.html#cb265-2" aria-hidden="true" tabindex="-1"></a>kids <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://ditraglia.com/data/child_test_data.csv&quot;</span>)</span>
<span id="cb265-3"><a href="predictive-regression-part-ii.html#cb265-3" aria-hidden="true" tabindex="-1"></a>kids <span class="ot">&lt;-</span> kids <span class="sc">%&gt;%</span></span>
<span id="cb265-4"><a href="predictive-regression-part-ii.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">kid_score =</span> kid.score,</span>
<span id="cb265-5"><a href="predictive-regression-part-ii.html#cb265-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mom_hs =</span> mom.hs, </span>
<span id="cb265-6"><a href="predictive-regression-part-ii.html#cb265-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mom_iq =</span> mom.iq, </span>
<span id="cb265-7"><a href="predictive-regression-part-ii.html#cb265-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mom_age =</span> mom.age)</span>
<span id="cb265-8"><a href="predictive-regression-part-ii.html#cb265-8" aria-hidden="true" tabindex="-1"></a>reg_pooled <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, kids)</span>
<span id="cb265-9"><a href="predictive-regression-part-ii.html#cb265-9" aria-hidden="true" tabindex="-1"></a>reg_hs_dummy <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">+</span> mom_hs, kids)</span>
<span id="cb265-10"><a href="predictive-regression-part-ii.html#cb265-10" aria-hidden="true" tabindex="-1"></a>reg_interact <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">*</span> mom_hs, kids)</span></code></pre></div>
</div>
<div id="predicting-new-observations" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Predicting New Observations<a href="predictive-regression-part-ii.html#predicting-new-observations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>predict()</code> command allows us to predict new observations using a fitted statistical model. As we'll see in future lessons, <code>predict()</code> works with a variety of models besides linear regression. In this lesson we'll restrict our attention to making predictions based on a linear regression fitted with <code>lm()</code>.</p>
<p>The simplest way to use <code>predict()</code> is by passing it a single argument: a regression fitted with <code>lm()</code>. When used in this way, it returns the vector of <em>fitted values</em> from the regression. As such <code>predict([REGRESSION])</code> is synonymous with <code>fitted.values([REGRESSION])</code>:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="predictive-regression-part-ii.html#cb266-1" aria-hidden="true" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg_hs_dummy)</span>
<span id="cb266-2"><a href="predictive-regression-part-ii.html#cb266-2" aria-hidden="true" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> <span class="fu">fitted.values</span>(reg_hs_dummy)</span>
<span id="cb266-3"><a href="predictive-regression-part-ii.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(yhat1, yhat2))</span></code></pre></div>
<pre><code>##      yhat1    yhat2
## 1 99.98056 99.98056
## 2 82.07336 82.07336
## 3 96.78075 96.78075
## 4 87.76191 87.76191
## 5 83.98152 83.98152
## 6 86.57804 86.57804</code></pre>
<p>This make sense if you think of the fitted values as <em>in-sample predictions</em>, the predictions that we would make for the individuals we used to fit our regression. To make predictions for <em>new individuals</em>, we need to supply a second argument to <code>predict()</code>, a data frame called <code>newdata</code>. This data frame should have the same column names as the data we used to fit our regression, and contain the same kind of information. In short: <code>newdata</code> contains the predictors <span class="math inline">\(X\)</span> for one or more individuals who are <em>not</em> in our dataset; given this information, <code>predict()</code> extracts the estimated regression coefficients <span class="math inline">\(\widehat{\beta}\)</span> and computes <span class="math inline">\(X\widehat{\beta}\)</span>.</p>
<p>Let's try a simple example. Suppose we wanted to use <code>reg_pooled_hs</code> to predict <code>kid_score</code> for a child whose mother has an IQ of <code>100</code> and did not graduate from high school. One way to do this is "by hand" using <code>coef()</code></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="predictive-regression-part-ii.html#cb268-1" aria-hidden="true" tabindex="-1"></a>b_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg_hs_dummy)</span>
<span id="cb268-2"><a href="predictive-regression-part-ii.html#cb268-2" aria-hidden="true" tabindex="-1"></a>b_hat</span></code></pre></div>
<pre><code>## (Intercept)      mom_iq      mom_hs 
##   25.731538    0.563906    5.950117</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="predictive-regression-part-ii.html#cb270-1" aria-hidden="true" tabindex="-1"></a>b_hat[<span class="dv">1</span>] <span class="sc">+</span> b_hat[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> b_hat[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## (Intercept) 
##    82.12214</code></pre>
<p>Another is by first constructing a data frame with information on this particular hypothetical child and passing it as the <code>newdata</code> argument of <code>predict()</code>:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="predictive-regression-part-ii.html#cb272-1" aria-hidden="true" tabindex="-1"></a>new_kid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mom_iq =</span> <span class="dv">100</span>, <span class="at">mom_hs =</span> <span class="dv">0</span>)</span>
<span id="cb272-2"><a href="predictive-regression-part-ii.html#cb272-2" aria-hidden="true" tabindex="-1"></a>new_kid</span></code></pre></div>
<pre><code>##   mom_iq mom_hs
## 1    100      0</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="predictive-regression-part-ii.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg_hs_dummy, new_kid)</span></code></pre></div>
<pre><code>##        1 
## 82.12214</code></pre>
<p>The real value of the second approach becomes apparent when we want to make <em>multiple predictions at once</em>. For example,</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="predictive-regression-part-ii.html#cb276-1" aria-hidden="true" tabindex="-1"></a>new_kids <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mom_iq =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">80</span>),</span>
<span id="cb276-2"><a href="predictive-regression-part-ii.html#cb276-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mom_hs =</span> <span class="fu">c</span>(  <span class="dv">0</span>,   <span class="dv">1</span>,  <span class="dv">1</span>))</span>
<span id="cb276-3"><a href="predictive-regression-part-ii.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg_hs_dummy, new_kids)</span></code></pre></div>
<pre><code>##        1        2        3 
## 82.12214 99.35038 76.79414</code></pre>
<p>It's crucial that the <em>names</em> of the columns in <code>newdata</code> match those of the regression that you pass as the first argument to <code>predict()</code>. This, for example will throw an error:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="predictive-regression-part-ii.html#cb278-1" aria-hidden="true" tabindex="-1"></a>other_kids <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iq =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">80</span>), </span>
<span id="cb278-2"><a href="predictive-regression-part-ii.html#cb278-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">hs =</span> <span class="fu">c</span>(  <span class="dv">0</span>,   <span class="dv">1</span>,  <span class="dv">1</span>))</span>
<span id="cb278-3"><a href="predictive-regression-part-ii.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg_hs_dummy, other_kids)</span></code></pre></div>
<pre><code>## Error in eval(predvars, data, env): object &#39;mom_iq&#39; not found</code></pre>
<p>Including extraneous columns in <code>newdata</code>, on the other hand, is perfectly fine. This can come in handy when you want to predict from multiple different fitted regressions. For example, it's perfectly fine to predict using <code>reg_pooled</code> and <code>new_kids</code> even though <code>reg_pooled</code> does not include <code>mom_hs</code> as a predictor:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="predictive-regression-part-ii.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg_pooled, new_kids)</span></code></pre></div>
<pre><code>##        1        2        3 
## 86.79724 98.99673 74.59774</code></pre>
<p>Before I turn you loose on the exercise, here's one more useful trick that doesn't <em>technically</em> count as a use of <code>predict()</code>, but is closely related. In our last lesson we learned how to use <code>augment()</code> from the <code>broom</code> package to add a column with residuals and fitted values to a data frame that we used to fit a regression. It turns out that we can use the same idea to add <em>predicted</em> values to a data frame of <span class="math inline">\(X\)</span> values at which we'd like to predict. For example, to add the result of running <code>predict(reg_pooled, new_kids)</code> as an additional column of <code>new_kids</code>, we can run the following line of code:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="predictive-regression-part-ii.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb282-2"><a href="predictive-regression-part-ii.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(reg_pooled, <span class="at">newdata =</span> new_kids)</span></code></pre></div>
<pre><code>## # A tibble: 3  3
##   mom_iq mom_hs .fitted
##    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1    100      0    86.8
## 2    120      1    99.0
## 3     80      1    74.6</code></pre>
<p>The third column is still called <code>.fitted</code> but in this case it actually contains <em>predicted</em> values. Note that these agree perfectly with those that we computed above. To avoid confusion, it's worth renaming this column using the <code>rename()</code> command from <code>dplyr</code></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="predictive-regression-part-ii.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(reg_pooled, <span class="at">newdata =</span> new_kids) <span class="sc">%&gt;%</span></span>
<span id="cb284-2"><a href="predictive-regression-part-ii.html#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">kid_score_pred =</span> .fitted)</span></code></pre></div>
<pre><code>## # A tibble: 3  3
##   mom_iq mom_hs kid_score_pred
##    &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
## 1    100      0           86.8
## 2    120      1           99.0
## 3     80      1           74.6</code></pre>
<div id="exercise-27" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Exercise<a href="predictive-regression-part-ii.html#exercise-27" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>What values of <code>kid_score</code> would we predict for the children in the data frame <code>new_kids</code> based on the results of the regression <code>reg_interact</code>?</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="predictive-regression-part-ii.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(reg_interact, new_kids)</span></code></pre></div>
<pre><code>##        1        2        3 
## 85.40690 97.93995 78.55537</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Approximately 80% of the children in our <code>kids</code> dataset have mothers who graduated high school. The average IQ of these mothers is around 102 with a standard deviation of 15. For the 20% of mothers who did not graduate, the average IQ is around 92 with a standard deviation of 13. Under the assumption that the IQ for each group of mothers follows a normal distribution in the population as a whole, use this information to generate 10,000 <em>simulated kids</em>. Store their values of <code>mom_iq</code> and <code>mom_hs</code> as the columns of a data frame called <code>sim_kids</code>. Plot a histogram of the simulated values of <code>mom_iq</code>. How do they compare to the <em>true</em> values of <code>mom_iq</code> from <code>kids</code>?</li>
</ol>
<div class="webex-solution">
<button>
Show Hint
</button>
<p>First construct a vector of simulated <code>mom_hs</code> values using <code>rbinom()</code>. Call it <code>mom_hs_sim</code>. Next use <code>ifelse()</code> to construct a vector of means, <code>mu</code>, and standard deviations, <code>sigma</code>, that correspond to <code>mom_hs_sim</code>. Pass these as arguments to <code>rnorm()</code> to construct the simulated values of <code>mom_iq</code>.</p>
</div>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="predictive-regression-part-ii.html#cb288-1" aria-hidden="true" tabindex="-1"></a>n_sim_kids <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb288-2"><a href="predictive-regression-part-ii.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb288-3"><a href="predictive-regression-part-ii.html#cb288-3" aria-hidden="true" tabindex="-1"></a>mom_hs_sim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_sim_kids, <span class="dv">1</span>, <span class="fl">0.8</span>)</span>
<span id="cb288-4"><a href="predictive-regression-part-ii.html#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="predictive-regression-part-ii.html#cb288-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mom_hs_sim <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">92</span>, <span class="dv">102</span>) </span>
<span id="cb288-6"><a href="predictive-regression-part-ii.html#cb288-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mom_hs_sim <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">13</span>, <span class="dv">15</span>) </span>
<span id="cb288-7"><a href="predictive-regression-part-ii.html#cb288-7" aria-hidden="true" tabindex="-1"></a>mom_iq_sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sim_kids, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb288-8"><a href="predictive-regression-part-ii.html#cb288-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-9"><a href="predictive-regression-part-ii.html#cb288-9" aria-hidden="true" tabindex="-1"></a>sim_kids <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mom_iq =</span> mom_iq_sim,</span>
<span id="cb288-10"><a href="predictive-regression-part-ii.html#cb288-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mom_hs =</span> mom_hs_sim)</span>
<span id="cb288-11"><a href="predictive-regression-part-ii.html#cb288-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-12"><a href="predictive-regression-part-ii.html#cb288-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I *store* the plot rather than displaying it, so I can </span></span>
<span id="cb288-13"><a href="predictive-regression-part-ii.html#cb288-13" aria-hidden="true" tabindex="-1"></a><span class="co"># put it next to the plot of the true mom_iq values</span></span>
<span id="cb288-14"><a href="predictive-regression-part-ii.html#cb288-14" aria-hidden="true" tabindex="-1"></a>sim_mom_iq_plot <span class="ot">&lt;-</span> sim_kids <span class="sc">%&gt;%</span></span>
<span id="cb288-15"><a href="predictive-regression-part-ii.html#cb288-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb288-16"><a href="predictive-regression-part-ii.html#cb288-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq), <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb288-17"><a href="predictive-regression-part-ii.html#cb288-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;simulated&#39;</span>)</span>
<span id="cb288-18"><a href="predictive-regression-part-ii.html#cb288-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-19"><a href="predictive-regression-part-ii.html#cb288-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Again, I *store* the plot rather than displaying it</span></span>
<span id="cb288-20"><a href="predictive-regression-part-ii.html#cb288-20" aria-hidden="true" tabindex="-1"></a>true_mom_iq_plot <span class="ot">&lt;-</span> kids <span class="sc">%&gt;%</span></span>
<span id="cb288-21"><a href="predictive-regression-part-ii.html#cb288-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb288-22"><a href="predictive-regression-part-ii.html#cb288-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> mom_iq), <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb288-23"><a href="predictive-regression-part-ii.html#cb288-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;true&#39;</span>)</span>
<span id="cb288-24"><a href="predictive-regression-part-ii.html#cb288-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-25"><a href="predictive-regression-part-ii.html#cb288-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.arrange() from the gridExtra package is a handy way of </span></span>
<span id="cb288-26"><a href="predictive-regression-part-ii.html#cb288-26" aria-hidden="true" tabindex="-1"></a><span class="co"># arranging multiple ggplots in a grid</span></span>
<span id="cb288-27"><a href="predictive-regression-part-ii.html#cb288-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) </span>
<span id="cb288-28"><a href="predictive-regression-part-ii.html#cb288-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(sim_mom_iq_plot, true_mom_iq_plot, <span class="at">ncol =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="erm-book_files/figure-html/unnamed-chunk-169-1.png" width="672" />
The distribution of <code>mom_iq_sim</code> is roughly symmetric and unimodel. The actual distribution of <code>mom_iq</code> clearly isn't.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Use <code>augment()</code> from <code>broom</code> too add a column called <code>kid_score_pred</code> to <code>sim_kids</code>, containing the predicted test scores for these simulated children based on the fitted regression <code>reg_interact</code>. Plot a histogram of <code>kid_score_pred</code> and compare it to that of <code>kid_score</code> from <code>kids</code>.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="predictive-regression-part-ii.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store rather than display this plot</span></span>
<span id="cb289-2"><a href="predictive-regression-part-ii.html#cb289-2" aria-hidden="true" tabindex="-1"></a>kid_score_pred_plot <span class="ot">&lt;-</span> <span class="fu">augment</span>(reg_interact, <span class="at">newdata =</span> sim_kids) <span class="sc">%&gt;%</span></span>
<span id="cb289-3"><a href="predictive-regression-part-ii.html#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">kid_score_pred =</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb289-4"><a href="predictive-regression-part-ii.html#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span>  </span>
<span id="cb289-5"><a href="predictive-regression-part-ii.html#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> kid_score_pred), <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb289-6"><a href="predictive-regression-part-ii.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;simulated&#39;</span>)</span>
<span id="cb289-7"><a href="predictive-regression-part-ii.html#cb289-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-8"><a href="predictive-regression-part-ii.html#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Store rather than display this plot</span></span>
<span id="cb289-9"><a href="predictive-regression-part-ii.html#cb289-9" aria-hidden="true" tabindex="-1"></a>kid_score_plot <span class="ot">&lt;-</span> kids <span class="sc">%&gt;%</span></span>
<span id="cb289-10"><a href="predictive-regression-part-ii.html#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb289-11"><a href="predictive-regression-part-ii.html#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> kid_score), <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb289-12"><a href="predictive-regression-part-ii.html#cb289-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;true&#39;</span>)</span>
<span id="cb289-13"><a href="predictive-regression-part-ii.html#cb289-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-14"><a href="predictive-regression-part-ii.html#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="co"># As above: a handy way of arranging multiple ggplots</span></span>
<span id="cb289-15"><a href="predictive-regression-part-ii.html#cb289-15" aria-hidden="true" tabindex="-1"></a><span class="co"># in a grid layout</span></span>
<span id="cb289-16"><a href="predictive-regression-part-ii.html#cb289-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(kid_score_pred_plot, kid_score_plot, <span class="at">ncol =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="erm-book_files/figure-html/unnamed-chunk-170-1.png" width="672" />
The distribution of <code>kid_score_pred</code> is clearly left skewed, like that of <code>kid_score</code>. But there are some important differences: our simulation produces values of <code>kid_score</code> that are too tightly clustered around the mode. In the real data, scores below 50 and above 100 are common, but in the simulation they're extremely rare.</p>
</div>
</div>
</div>
<div id="testing-a-linear-restriction" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Testing a Linear Restriction<a href="predictive-regression-part-ii.html#testing-a-linear-restriction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Null hypothesis significance testing (NHST) is widely-used, and widely abused. In a future lesson I'll try to convince you that it's rarely of much practical use in applied work.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> That said, there are some special situations where a hypothesis test can come in handy. More importantly, if you want to replicate the work of researchers who haven't gotten <a href="https://www.amstat.org/asa/files/pdfs/P-ValueStatement.pdf">the memo on statistical significance</a>, you need to know something about NHST. In this section we'll learn how to carry out classical test of a <em>linear restriction</em>. For the moment I will assume that the regression errors are homoskedastic. Later in this lesson we'll learn how to adjust for heteroskedasticity.</p>
<p>The regression output provided by <code>summary()</code>, or in a tidier form by <code>tidy()</code>, makes it easy to test a null hypothesis of the form <span class="math inline">\(H_0\colon \beta_j = 0\)</span> against the two-sided alternative <span class="math inline">\(H_1 \colon \beta_j \neq 0\)</span>. Not only do they provide the point estimates <span class="math inline">\(\widehat{\beta}_j\)</span> and associated standard errors <span class="math inline">\(\text{SE}_j\)</span>, they also provide the t-statistic <span class="math inline">\(\widehat{\beta}_j/\text{SE}_j\)</span> and p-value for this very null hypothesis! In this example, we would soundly reject the null hypothesis that the coefficient on <code>mom_iq</code> is zero:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="predictive-regression-part-ii.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(reg_pooled)</span></code></pre></div>
<pre><code>## # A tibble: 2  5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   25.8      5.92        4.36 1.63e- 5
## 2 mom_iq         0.610    0.0585     10.4  7.66e-23</code></pre>
<p>For any other test that we might want to carry out, however, this output is less helpful. Suppose that we wanted to test <span class="math inline">\(H_0\colon \beta_j = b\)</span> against the two-sided alternative where <span class="math inline">\(b\)</span> is some constant that does <em>not</em> equal zero. We could of course construct the t-statistic "by hand" using the regression output. For example, we construct the test statistic for a test of the null hypothesis that the coefficient on <code>mom_iq</code> equals 1 as follows:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="predictive-regression-part-ii.html#cb292-1" aria-hidden="true" tabindex="-1"></a>results_pooled <span class="ot">&lt;-</span> <span class="fu">tidy</span>(reg_pooled)</span>
<span id="cb292-2"><a href="predictive-regression-part-ii.html#cb292-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb292-3"><a href="predictive-regression-part-ii.html#cb292-3" aria-hidden="true" tabindex="-1"></a>test_stat <span class="ot">&lt;-</span> <span class="fu">with</span>(results_pooled, <span class="fu">abs</span>(estimate[<span class="dv">2</span>] <span class="sc">-</span> b) <span class="sc">/</span> std.error[<span class="dv">2</span>])</span>
<span id="cb292-4"><a href="predictive-regression-part-ii.html#cb292-4" aria-hidden="true" tabindex="-1"></a>test_stat</span></code></pre></div>
<pre><code>## [1] 6.664718</code></pre>
<p>From there we could calculate a p-value if desired. This approach works, but it's tedious. It also leaves us with ample opportunity to make a careless error in the calculation. Fortunately there's a better way!</p>
<p>Testing <span class="math inline">\(H_0\colon \beta_j = b\)</span> is a special case of the more general problem of testing a <em>linear restriction</em>. In full generality, a test of a linear restriction takes the form
<span class="math display">\[
H_0\colon \mathbf{R}\beta = \mathbf{q} \quad \text{versus} \quad H_1\colon \mathbf{R}\beta \neq \mathbf{q}
\]</span>
where <span class="math inline">\(\mathbf{R}\)</span> is a <span class="math inline">\(J \times K\)</span> matrix of constants, <span class="math inline">\(\mathbf{q}\)</span> is <span class="math inline">\(J\)</span>-vector of constants, and <span class="math inline">\(\beta\)</span> is the regression parameter vector. If you haven't seen this before or have nightmares because you <em>have</em> seen it before, don't be put off: the only reason I'm showing you this notation is to clarify which kinds of hypotheses constitute a <em>linear restriction</em>. Here are a some examples. Each of them can be written in the form given above by choosing the appropriate <span class="math inline">\(\mathbf{R}\)</span> matrix and <span class="math inline">\(\mathbf{q}\)</span> vector:</p>
<ul>
<li><span class="math inline">\(H_0\colon \beta_j = 2\)</span></li>
<li><span class="math inline">\(H_0\colon \beta_1 = \beta_2\)</span></li>
<li><span class="math inline">\(H_0\colon \beta_1 + \beta_2 + \beta_3 = 1\)</span></li>
<li><span class="math inline">\(H_0\colon \beta_1 = 0 \text{ and } \beta_2 = \beta_3\)</span></li>
</ul>
<p>The <code>linearHypothesis()</code> command from the <code>car</code> package makes it easy to conduct a Wald test of a linear restriction based on a regression model fitted with <code>lm()</code>. The first argument of <code>linearHypothesis()</code> is the <em>unrestricted model</em>, a regression that we've already fit using <code>lm()</code>.<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> The second argument is a description of the hypothesis we wish to test. For example to test that the coefficient on <code>mom_iq</code> equals 1, we can use the following command:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="predictive-regression-part-ii.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb294-2"><a href="predictive-regression-part-ii.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_pooled, <span class="st">&#39;mom_iq = 1&#39;</span>)</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_iq = 1
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq
## 
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    433 158958                                  
## 2    432 144137  1     14820 44.419 8.107e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To test that the intercept equals zero, a very silly hypothesis indeed, we simply need to replace <code>'mom_iq = 1'</code> with <code>'(Intercept) = 0'</code></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="predictive-regression-part-ii.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_pooled, <span class="st">&#39;(Intercept) = 1&#39;</span>)</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## (Intercept) = 1
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq
## 
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)    
## 1    433 149998                                 
## 2    432 144137  1    5860.4 17.564 3.37e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To test the <em>joint</em> null hypothesis that both of these restrictions hold simultaneously, we supply a <em>vector</em> as the second argument. Each element of the vector describes one of the restrictions:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="predictive-regression-part-ii.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_pooled, <span class="fu">c</span>(<span class="st">&#39;mom_iq = 1&#39;</span>, <span class="st">&#39;(Intercept) = 1&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_iq = 1
## (Intercept) = 1
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq
## 
##   Res.Df    RSS Df Sum of Sq     F    Pr(&gt;F)    
## 1    434 246503                                 
## 2    432 144137  2    102366 153.4 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>By default <code>linearHypothesis()</code> carries out inference based on the F statistic. This is the "finite sample" Wald test. If you prefer the asymptotic version, based on a Chi-squared statistic, set the option <code>test = 'Chisq'</code>, for example</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="predictive-regression-part-ii.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_pooled, <span class="at">test =</span> <span class="st">&#39;Chisq&#39;</span>,</span>
<span id="cb300-2"><a href="predictive-regression-part-ii.html#cb300-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&#39;mom_iq = 1&#39;</span>, <span class="st">&#39;(Intercept) = 1&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_iq = 1
## (Intercept) = 1
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq
## 
##   Res.Df    RSS Df Sum of Sq  Chisq Pr(&gt;Chisq)    
## 1    434 246503                                   
## 2    432 144137  2    102366 306.81  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In this example it makes hardly any difference wich version of the test we use.</p>
<div id="exercise-28" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Exercise<a href="predictive-regression-part-ii.html#exercise-28" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Test the joint null hypothesis that the slope and intercept of the predictive relationship between <code>kid_score</code> and <code>mom_iq</code> is <em>the same</em> for kids whose mothers graduated from high school and those whose mothers did not. Does the p-value change much if you use the asymptotic version of the test rather than the finite-sample F?</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="predictive-regression-part-ii.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(reg_interact)</span></code></pre></div>
<pre><code>## # A tibble: 4  5
##   term          estimate std.error statistic  p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    -11.5      13.8      -0.835 4.04e- 1
## 2 mom_iq           0.969     0.148     6.53  1.84e-10
## 3 mom_hs          51.3      15.3       3.34  9.02e- 4
## 4 mom_iq:mom_hs   -0.484     0.162    -2.99  2.99e- 3</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="predictive-regression-part-ii.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact, <span class="fu">c</span>(<span class="st">&#39;mom_hs = 0&#39;</span>, <span class="st">&#39;mom_iq:mom_hs = 0&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_hs = 0
## mom_iq:mom_hs = 0
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    432 144137                                  
## 2    430 138879  2    5258.7 8.1411 0.0003386 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="predictive-regression-part-ii.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact, <span class="at">test =</span> <span class="st">&#39;Chisq&#39;</span>,</span>
<span id="cb306-2"><a href="predictive-regression-part-ii.html#cb306-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&#39;mom_hs = 0&#39;</span>, <span class="st">&#39;mom_iq:mom_hs = 0&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_hs = 0
## mom_iq:mom_hs = 0
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df    RSS Df Sum of Sq  Chisq Pr(&gt;Chisq)    
## 1    432 144137                                   
## 2    430 138879  2    5258.7 16.282  0.0002913 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Let <code>n</code> be the number of rows in <code>kids</code>. Generate two random vectors as follows: <code>x</code> is a vector of <code>n</code> independent standard normal noise while <code>z</code> equals <code>mom_iq</code> plus a vector of independent standard normal noise. Carry out a new regression, <code>reg_augmented</code>, that <em>augments</em> <code>reg_interact</code> by adding the predictors <code>x</code> and <code>z</code>. Then carry out an F-test the null hypothesis that <code>x</code> and <code>z</code> are irrelevant for predicting <code>mpg</code> after taking into account <code>mom_iq</code> and <code>mom_hs</code>. Interpret your findings. Do the results of the test make sense?</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="predictive-regression-part-ii.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb308-2"><a href="predictive-regression-part-ii.html#cb308-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(kids)</span>
<span id="cb308-3"><a href="predictive-regression-part-ii.html#cb308-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb308-4"><a href="predictive-regression-part-ii.html#cb308-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> kids<span class="sc">$</span>mom_iq <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb308-5"><a href="predictive-regression-part-ii.html#cb308-5" aria-hidden="true" tabindex="-1"></a>reg_augmented <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">*</span> mom_hs <span class="sc">+</span> x <span class="sc">+</span> z, kids) </span>
<span id="cb308-6"><a href="predictive-regression-part-ii.html#cb308-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(reg_augmented)</span></code></pre></div>
<pre><code>## # A tibble: 6  5
##   term          estimate std.error statistic  p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    -11.3      13.8      -0.818 0.414   
## 2 mom_iq           1.32      0.903     1.46  0.146   
## 3 mom_hs          51.2      15.4       3.33  0.000937
## 4 x                0.839     0.849     0.988 0.324   
## 5 z               -0.349     0.881    -0.396 0.692   
## 6 mom_iq:mom_hs   -0.483     0.163    -2.97  0.00311</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="predictive-regression-part-ii.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_augmented, <span class="fu">c</span>(<span class="st">&#39;x = 0&#39;</span>, <span class="st">&#39;z = 0&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## x = 0
## z = 0
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs + x + z
## 
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    430 138879                           
## 2    428 138497  2    381.94 0.5902 0.5547</code></pre>
<p>These results make sense: <code>x</code> was randomly generated so it clearly has nothing to do with <code>kid_score</code>. In contrast, because it's related to <code>mom_iq</code>, <code>z</code> clearly <em>is</em> related to <code>kid_score</code>, but doesn't contain and <em>additional</em> predictive information beyond that already contained in <code>mom_iq</code>.</p>
</div>
</div>
</div>
<div id="heteroskedasticity-robust-standard-errors-and-tests" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Heteroskedasticity-Robust Standard Errors and Tests<a href="predictive-regression-part-ii.html#heteroskedasticity-robust-standard-errors-and-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a linear regression model of the form <span class="math inline">\(Y_i = X_i&#39;\beta + \epsilon_i\)</span>.
If the variance of <span class="math inline">\(\epsilon_i\)</span> is unrelated to the predictors <span class="math inline">\(X_i\)</span>, we say that the regression errors are <em>homoskedastic</em>. This is just a fancy Greek work for <em>constant variance</em>. If instead, the variance of <span class="math inline">\(\epsilon_i\)</span> depends on the value of <span class="math inline">\(x_i\)</span>, we say that the regression errors are <em>heteroskedastic</em>. This is just a fancy Greek word for <em>non-constant variance</em>. Heteroskedasticity does not invalidate our least squares estimates of <span class="math inline">\(\beta\)</span>, but it does invalidate the formulas used by <code>lm()</code> to calculate standard errors and p-values. Fortunately there's a simple solution. In this lesson I'll show you how to implement the solution without explaining how it works. In a future lesson we'll take a closer look at robust standard errors</p>
<p>The command <code>lm_robust()</code> from the <code>estimatr</code> package works exactly like <code>lm()</code> <em>except</em> that it uses heteroskedasticity-robust standard errors by default. If you're familiar with Stata, <code>lm_robust()</code> is the equivalent of <code>reg robust</code>. Let's test this out on our model <code>kid_score ~ mom_iq * mom_hs</code> from above. Notice that the coefficients in <code>reg_interact_robust</code> are identical to those from <code>reg_interact</code></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="predictive-regression-part-ii.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb312-2"><a href="predictive-regression-part-ii.html#cb312-2" aria-hidden="true" tabindex="-1"></a>reg_interact_robust <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">*</span> mom_hs, kids)</span>
<span id="cb312-3"><a href="predictive-regression-part-ii.html#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">lm =</span> <span class="fu">coef</span>(reg_interact), <span class="at">lm_robust =</span> <span class="fu">coef</span>(reg_interact_robust))</span></code></pre></div>
<pre><code>##                        lm   lm_robust
## (Intercept)   -11.4820211 -11.4820211
## mom_iq          0.9688892   0.9688892
## mom_hs         51.2682234  51.2682234
## mom_iq:mom_hs  -0.4842747  -0.4842747</code></pre>
<p>The standard errors, on the other hand, are different:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="predictive-regression-part-ii.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">tidy</span>(reg_interact)[<span class="fu">c</span>(<span class="st">&#39;term&#39;</span>, <span class="st">&#39;std.error&#39;</span>)],</span>
<span id="cb314-2"><a href="predictive-regression-part-ii.html#cb314-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">robust.std.error =</span> <span class="fu">tidy</span>(reg_interact_robust)<span class="sc">$</span>std.error)</span></code></pre></div>
<pre><code>##            term  std.error robust.std.error
## 1   (Intercept) 13.7579737       13.4927605
## 2        mom_iq  0.1483437        0.1443046
## 3        mom_hs 15.3375805       15.1188068
## 4 mom_iq:mom_hs  0.1622171        0.1581182</code></pre>
<p>In this example the heteroskedasticity-robust standard errors are <em>slightly smaller</em>, although the difference is too small to be of practical relevance. As a general rule, correcting for possible heteroskedasticity tends to <em>increase</em> our standard errors, but this is not always the case, as we see from the preceding example.</p>
<p>There are actually various different "flavors" of heteroskedasticity-robust standard errors: HC0, HC1, HC2, and HC3. We'll have more to say about these in a future lesson. For now, the important thing to know is that <code>lm_robust()</code> defaults to HC2 whereas Stata defaults to HC1. To obtain a different flavor of robust standard error, you can set the <code>se_type</code> argument. To obtain standard errors that match those computed by <code>reg robust</code> in Stata you can either set <code>se_type = 'HC1'</code> or <code>se_type = 'stata'</code>. They do the same thing, but the latter is easier to remember.</p>
<p>Heteroskedasticity doesn't just invalidate inference based on the t-tests from the <code>lm</code> summary output; it also invalidates any that we carry out by passing these results to <code>linearHypothesis</code>. Fortunately, there's an easy fix: as long as we fit our regression using <code>lm_robust</code> in place of <code>lm</code>, <code>linearHypothesis</code> will automatically carry out a heteroskedasticity-robust test. For example:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="predictive-regression-part-ii.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact_robust, <span class="st">&#39;mom_iq = 0.8&#39;</span>)</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_iq = 0.8
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df Df  Chisq Pr(&gt;Chisq)
## 1    431                     
## 2    430  1 1.3698     0.2419</code></pre>
<p>Because the robust test relies on an <em>asymptotic</em> result, it uses a <span class="math inline">\(\chi^2\)</span> distribution. The non-robust test based on <code>reg_interact</code> is slightly different even if we set <code>test = 'Chisq'</code></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="predictive-regression-part-ii.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact, <span class="st">&#39;mom_iq = 0.8&#39;</span>, <span class="at">test =</span> <span class="st">&#39;Chisq&#39;</span>)</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_iq = 0.8
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df    RSS Df Sum of Sq  Chisq Pr(&gt;Chisq)
## 1    431 139297                               
## 2    430 138879  1    418.63 1.2962     0.2549</code></pre>
<p>Although both of these tests use a <span class="math inline">\(\chi^2\)</span> distribution with one degree of freedom, the test statistic differs between them. This is because the robust test uses a <em>different variance-covariance matrix estimate</em> when forming the Wald statistic.</p>
<div id="exercise-29" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Exercise<a href="predictive-regression-part-ii.html#exercise-29" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>If we had run <code>reg robust</code> in Stata, what standard errors would we have obtained in the regression model <code>kid_score ~ mom_iq * mom_hs</code> from above?</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="predictive-regression-part-ii.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_robust</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">*</span> mom_hs, kids, <span class="at">se_type =</span> <span class="st">&#39;stata&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb320-2"><a href="predictive-regression-part-ii.html#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb320-3"><a href="predictive-regression-part-ii.html#cb320-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, std.error)</span></code></pre></div>
<pre><code>##            term  std.error
## 1   (Intercept) 13.3292049
## 2        mom_iq  0.1423952
## 3        mom_hs 14.9719985
## 4 mom_iq:mom_hs  0.1563629</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Set <code>x</code> equal to <code>mom_iq</code> from <code>kids</code> and let <code>n</code> equal <code>length(x)</code>. Generate a vector of independent mean zero errors <code>epsilon</code> with standard deviation equal to <code>exp(1.3 + 0.8 * scale(x))</code>. Read the help file for <code>scale()</code> to make sure you understand what this function does. Plot <code>x</code> against <code>epsilon</code>. Are the errors contained in <code>epsilon</code> homoskedastic? Explain briefly.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="predictive-regression-part-ii.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb322-2"><a href="predictive-regression-part-ii.html#cb322-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> kids<span class="sc">$</span>mom_iq</span>
<span id="cb322-3"><a href="predictive-regression-part-ii.html#cb322-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb322-4"><a href="predictive-regression-part-ii.html#cb322-4" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">exp</span>(<span class="fl">1.3</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">scale</span>(x)))</span>
<span id="cb322-5"><a href="predictive-regression-part-ii.html#cb322-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(x, epsilon)</span></code></pre></div>
<p><img src="erm-book_files/figure-html/unnamed-chunk-184-1.png" width="672" />
The errors <code>epsilon</code> are clearly heteroskedastic: their variance is an <em>increasing</em> function of <code>x</code>. We can see this clearly in the plot: the values of <code>epsilon</code> "fan out" as <code>x</code> increases.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Generate a vector of simulated outcomes <code>y</code> according to <code>y &lt;- a + b * x + epsilon</code> where <code>a</code> and <code>b</code> are the intercept and slope from <code>reg_pooled</code>. Then regress <code>y</code> on <code>x</code> and calculate three kinds of standard errors: the usual ones from <code>lm()</code>, the HC2-flavored robust versions from <code>lm_robust()</code>, and the ones that would be produced by the Stata command <code>reg robust</code>. Comment on the differences between them.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="predictive-regression-part-ii.html#cb323-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">fitted.values</span>(reg_pooled) <span class="sc">+</span> epsilon</span>
<span id="cb323-2"><a href="predictive-regression-part-ii.html#cb323-2" aria-hidden="true" tabindex="-1"></a>reg_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb323-3"><a href="predictive-regression-part-ii.html#cb323-3" aria-hidden="true" tabindex="-1"></a>reg_sim_robust <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(y <span class="sc">~</span> x)</span>
<span id="cb323-4"><a href="predictive-regression-part-ii.html#cb323-4" aria-hidden="true" tabindex="-1"></a>reg_sim_stata <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(y <span class="sc">~</span> x, <span class="at">se_type =</span> <span class="st">&#39;stata&#39;</span>)</span>
<span id="cb323-5"><a href="predictive-regression-part-ii.html#cb323-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">tidy</span>(reg_sim)[, <span class="fu">c</span>(<span class="st">&#39;term&#39;</span>, <span class="st">&#39;std.error&#39;</span>)],</span>
<span id="cb323-6"><a href="predictive-regression-part-ii.html#cb323-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">HC2.std.error =</span> <span class="fu">tidy</span>(reg_sim_robust)<span class="sc">$</span>std.error,</span>
<span id="cb323-7"><a href="predictive-regression-part-ii.html#cb323-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">stata.std.error =</span> <span class="fu">tidy</span>(reg_sim_stata)<span class="sc">$</span>std.error)</span></code></pre></div>
<pre><code>##          term  std.error HC2.std.error stata.std.error
## 1 (Intercept) 2.15350326    3.30916120      3.29797118
## 2           x 0.02129732    0.03591114      0.03579134</code></pre>
<p>Here the robust standard errors are considerably larger, but the HC2 version is nearly identical to the Stata version (HC1).</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>In an earlier exercise from this lesson you tested the joint null hypothesis that the slope and intercept of the predictive relationship between <code>kid_score</code> and <code>mom_iq</code> was the same, regardless of whether a child's mother graduated from high school. Do the results change if you carry out a heteroskedasticity-robust version of the test?</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="predictive-regression-part-ii.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact, <span class="fu">c</span>(<span class="st">&#39;mom_hs = 0&#39;</span>, <span class="st">&#39;mom_iq:mom_hs = 0&#39;</span>),</span>
<span id="cb325-2"><a href="predictive-regression-part-ii.html#cb325-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&#39;Chisq&#39;</span>)</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_hs = 0
## mom_iq:mom_hs = 0
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df    RSS Df Sum of Sq  Chisq Pr(&gt;Chisq)    
## 1    432 144137                                   
## 2    430 138879  2    5258.7 16.282  0.0002913 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="predictive-regression-part-ii.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(reg_interact_robust, <span class="fu">c</span>(<span class="st">&#39;mom_hs = 0&#39;</span>, <span class="st">&#39;mom_iq:mom_hs = 0&#39;</span>))</span></code></pre></div>
<pre><code>## Linear hypothesis test
## 
## Hypothesis:
## mom_hs = 0
## mom_iq:mom_hs = 0
## 
## Model 1: restricted model
## Model 2: kid_score ~ mom_iq * mom_hs
## 
##   Res.Df Df  Chisq Pr(&gt;Chisq)    
## 1    432                         
## 2    430  2 15.101  0.0005258 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To make this an apples-to-apples comparison, I use the <span class="math inline">\(\chi^2\)</span> version of the non-robust test. Although the test statistics vary slightly, there's no meaningful difference in results here.</p>
</div>
</div>
</div>
<div id="publication-quality-tables" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Publication Quality Tables<a href="predictive-regression-part-ii.html#publication-quality-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A crucial part of communicating our results in a statistical analysis creating tables that are clear, and easy to read. In this section we'll learn how to use the <a href="https://vincentarelbundock.github.io/modelsummary/"><code>modelsummary</code> package</a> to generate reproducible, publication-quality tables like those that appear in academic journals. It would take multiple lessons to do full justice to <code>modelsummary</code>. Here I'll show you some common and fairly simple use cases. To learn more, see this tutorial on <a href="https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html">basic options</a> and this one on more advanced <a href="https://vincentarelbundock.github.io/modelsummary/articles/appearance.html">customization</a>.</p>
<div id="datasummary_skim" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> <code>datasummary_skim()</code><a href="predictive-regression-part-ii.html#datasummary_skim" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>datasummary_skim()</code> function from <code>modelsummary</code> makes it easy to construct simple tables of summary statistics. Simply pass it a data frame, and it will return a helpful table complete with cute little histograms! (If you don't want the histograms, you can set <code>histogram = FALSE</code>.)</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="predictive-regression-part-ii.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb329-2"><a href="predictive-regression-part-ii.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(kids)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Unique (#)
</th>
<th style="text-align:right;">
Missing (%)
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
Max
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
kid_score
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.8
</td>
<td style="text-align:right;">
20.4
</td>
<td style="text-align:right;">
20.0
</td>
<td style="text-align:right;">
90.0
</td>
<td style="text-align:right;">
144.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="11.57" width="3.58" height="0.088" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="5.36" y="11.49" width="3.58" height="0.18" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="8.95" y="9.38" width="3.58" height="2.29" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="12.53" y="9.11" width="3.58" height="2.55" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="16.11" y="8.41" width="3.58" height="3.25" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="19.70" y="7.35" width="3.58" height="4.31" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="23.28" y="4.89" width="3.58" height="6.77" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="26.87" y="3.22" width="3.58" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="30.45" y="4.80" width="3.58" height="6.86" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="34.04" y="9.11" width="3.58" height="2.55" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.62" y="11.05" width="3.58" height="0.62" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="41.20" y="11.49" width="3.58" height="0.18" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="44.79" y="11.57" width="3.58" height="0.088" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_hs
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="9.36" width="4.44" height="2.30" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="6.22" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="10.67" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="15.11" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="19.56" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.00" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="28.44" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="32.89" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.33" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="41.78" y="3.22" width="4.44" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:right;">
332
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.0
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
71.0
</td>
<td style="text-align:right;">
97.9
</td>
<td style="text-align:right;">
138.9
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.10" y="10.91" width="3.27" height="0.75" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="4.37" y="8.19" width="3.27" height="3.47" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="7.65" y="4.42" width="3.27" height="7.24" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="10.92" y="3.37" width="3.27" height="8.29" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="14.20" y="3.82" width="3.27" height="7.84" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="17.47" y="3.22" width="3.27" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="20.75" y="4.12" width="3.27" height="7.54" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.02" y="6.84" width="3.27" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="27.30" y="6.84" width="3.27" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="30.57" y="7.59" width="3.27" height="4.07" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="33.85" y="8.65" width="3.27" height="3.02" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.12" y="8.80" width="3.27" height="2.87" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="40.40" y="10.00" width="3.27" height="1.66" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="43.67" y="11.06" width="3.27" height="0.60" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_age
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
17.0
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
29.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="9.52" width="3.70" height="2.14" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="5.48" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="9.19" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="12.89" y="4.69" width="3.70" height="6.97" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="16.59" y="4.02" width="3.70" height="7.64" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="20.30" y="3.22" width="3.70" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.00" y="5.23" width="3.70" height="6.43" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="27.70" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="31.41" y="6.84" width="3.70" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="35.11" y="8.85" width="3.70" height="2.81" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="38.81" y="9.79" width="3.70" height="1.88" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="42.52" y="10.72" width="3.70" height="0.94" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
</tbody>
</table>
<p>The summary statistics for <code>mom_hs</code> are a bit silly: there's no point in reporting the standard deviation of a binary variable, since this is a deterministic function of the mean. The problem here is that <code>datasummary_skim</code> has no way of knowing that we have encoded a <em>categorical variable</em> using the values <code>0</code> and <code>1</code>. In our last lesson I mentioned that it's better to explicitly store categorical variables as <em>factors</em> in R, and suggested replacing <code>mom_hs</code> with <code>mom_education</code> as follows:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="predictive-regression-part-ii.html#cb330-1" aria-hidden="true" tabindex="-1"></a>kids_cat <span class="ot">&lt;-</span> kids <span class="sc">%&gt;%</span> </span>
<span id="cb330-2"><a href="predictive-regression-part-ii.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mom_education =</span> <span class="fu">if_else</span>(mom_hs <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb330-3"><a href="predictive-regression-part-ii.html#cb330-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&#39;High School&#39;</span>, </span>
<span id="cb330-4"><a href="predictive-regression-part-ii.html#cb330-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&#39;No High School&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb330-5"><a href="predictive-regression-part-ii.html#cb330-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mom_education =</span> <span class="fu">factor</span>(mom_education, </span>
<span id="cb330-6"><a href="predictive-regression-part-ii.html#cb330-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">unique</span>(mom_education))) <span class="sc">%&gt;%</span></span>
<span id="cb330-7"><a href="predictive-regression-part-ii.html#cb330-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>mom_hs)</span></code></pre></div>
<p>If we make explicit which variables are categorical and which aren't, <code>datasummary_skim()</code> will <em>drop</em> any categorical variables by default:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="predictive-regression-part-ii.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(kids_cat)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Unique (#)
</th>
<th style="text-align:right;">
Missing (%)
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
Max
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
kid_score
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
86.8
</td>
<td style="text-align:right;">
20.4
</td>
<td style="text-align:right;">
20.0
</td>
<td style="text-align:right;">
90.0
</td>
<td style="text-align:right;">
144.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="11.57" width="3.58" height="0.088" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="5.36" y="11.49" width="3.58" height="0.18" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="8.95" y="9.38" width="3.58" height="2.29" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="12.53" y="9.11" width="3.58" height="2.55" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="16.11" y="8.41" width="3.58" height="3.25" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="19.70" y="7.35" width="3.58" height="4.31" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="23.28" y="4.89" width="3.58" height="6.77" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="26.87" y="3.22" width="3.58" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="30.45" y="4.80" width="3.58" height="6.86" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="34.04" y="9.11" width="3.58" height="2.55" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.62" y="11.05" width="3.58" height="0.62" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="41.20" y="11.49" width="3.58" height="0.18" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="44.79" y="11.57" width="3.58" height="0.088" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:right;">
332
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.0
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
71.0
</td>
<td style="text-align:right;">
97.9
</td>
<td style="text-align:right;">
138.9
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.10" y="10.91" width="3.27" height="0.75" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="4.37" y="8.19" width="3.27" height="3.47" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="7.65" y="4.42" width="3.27" height="7.24" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="10.92" y="3.37" width="3.27" height="8.29" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="14.20" y="3.82" width="3.27" height="7.84" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="17.47" y="3.22" width="3.27" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="20.75" y="4.12" width="3.27" height="7.54" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.02" y="6.84" width="3.27" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="27.30" y="6.84" width="3.27" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="30.57" y="7.59" width="3.27" height="4.07" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="33.85" y="8.65" width="3.27" height="3.02" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.12" y="8.80" width="3.27" height="2.87" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="40.40" y="10.00" width="3.27" height="1.66" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="43.67" y="11.06" width="3.27" height="0.60" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_age
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
17.0
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
29.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="9.52" width="3.70" height="2.14" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="5.48" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="9.19" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="12.89" y="4.69" width="3.70" height="6.97" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="16.59" y="4.02" width="3.70" height="7.64" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="20.30" y="3.22" width="3.70" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.00" y="5.23" width="3.70" height="6.43" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="27.70" y="6.30" width="3.70" height="5.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="31.41" y="6.84" width="3.70" height="4.83" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="35.11" y="8.85" width="3.70" height="2.81" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="38.81" y="9.79" width="3.70" height="1.88" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="42.52" y="10.72" width="3.70" height="0.94" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
</tbody>
</table>
<p>To make a table of <em>only</em> the categorical variables, set <code>type = 'categorical'</code></p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="predictive-regression-part-ii.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(kids_cat, <span class="at">type =</span> <span class="st">&#39;categorical&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
mom_education
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
High School
</td>
<td style="text-align:right;">
341
</td>
<td style="text-align:right;">
78.6
</td>
</tr>
<tr>
<td style="text-align:left;">
No High School
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
21.4
</td>
</tr>
</tbody>
</table>
</div>
<div id="datasummary_balance" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> <code>datasummary_balance()</code><a href="predictive-regression-part-ii.html#datasummary_balance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It can sometimes be helpful to compare summary statistics across categories defined by a "grouping variable." For example, we may be interested to know how <code>kid_score</code>, <code>mom_iq</code>, and <code>mom_age</code> vary with <code>mom_education</code>. The <code>datasummary_balance()</code> function makes this easy:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="predictive-regression-part-ii.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_balance</span>(<span class="sc">~</span> mom_education, <span class="at">data =</span> kids_cat)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
High School (N=341)
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
No High School (N=93)
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Std. Dev.
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Std. Dev.
</th>
<th style="text-align:right;">
Diff. in Means
</th>
<th style="text-align:right;">
Std. Error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
kid_score
</td>
<td style="text-align:right;">
89.3
</td>
<td style="text-align:right;">
19.0
</td>
<td style="text-align:right;">
77.5
</td>
<td style="text-align:right;">
22.6
</td>
<td style="text-align:right;">
-11.8
</td>
<td style="text-align:right;">
2.6
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:right;">
102.2
</td>
<td style="text-align:right;">
14.8
</td>
<td style="text-align:right;">
91.9
</td>
<td style="text-align:right;">
12.6
</td>
<td style="text-align:right;">
-10.3
</td>
<td style="text-align:right;">
1.5
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_age
</td>
<td style="text-align:right;">
23.1
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
21.7
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
-1.4
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
</tbody>
</table>
<p>The second argument of <code>datasummary_balance()</code> is the data frame we wish to summarize. The first is a <em>one-sided formula</em> that takes the form <code>~ [GROUPING VARIABLE]</code>. The idea here is that <code>[GROUPING VARIABLE]</code> is analogous to a RHS variable in a regression formula. The syntax makes sense if you think about it: this table is equivalent to "regressing" all of the variables in <code>kids_cat</code> on <code>mom_eduation</code>.</p>
</div>
<div id="modelsummary" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> <code>modelsummary()</code><a href="predictive-regression-part-ii.html#modelsummary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>modelsummary()</code> produces summary tables for statistical models, including linear regressions. The simplest way to use it is by passing a single argument: a fitted model such as <code>reg_pooled</code></p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="predictive-regression-part-ii.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(reg_pooled)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
25.800
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(5.917)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:center;">
0.610
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.059)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.201
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.199
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
3757.2
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
3769.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
1875.608
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
108.643
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
18.27
</td>
</tr>
</tbody>
</table>
<p>But it is with multiple models that <code>modelsummary()</code> shows its true power. Recall that we fitted a number of different regressions based on the <code>kids</code> dataset. To display them all at once in a format that permits easy comparisons, we simply need to create a <em>list</em> of the fitted models:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="predictive-regression-part-ii.html#cb335-1" aria-hidden="true" tabindex="-1"></a>kids_regressions <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&#39;OLS 1&#39;</span> <span class="ot">=</span> reg_pooled,</span>
<span id="cb335-2"><a href="predictive-regression-part-ii.html#cb335-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;OLS 2&#39;</span> <span class="ot">=</span> reg_hs_dummy,</span>
<span id="cb335-3"><a href="predictive-regression-part-ii.html#cb335-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;OLS 3&#39;</span> <span class="ot">=</span> reg_interact)</span></code></pre></div>
<p>When we pass <code>kids_regressions</code> to <code>modelsummary()</code> it will magically line up the estimates from each model that correspond to the same regressor, and add the names that I provided when creating the list of results:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="predictive-regression-part-ii.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(kids_regressions)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS 1
</th>
<th style="text-align:center;">
OLS 2
</th>
<th style="text-align:center;">
OLS 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
25.800
</td>
<td style="text-align:center;">
25.732
</td>
<td style="text-align:center;">
11.482
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(5.917)
</td>
<td style="text-align:center;">
(5.875)
</td>
<td style="text-align:center;">
(13.758)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:center;">
0.610
</td>
<td style="text-align:center;">
0.564
</td>
<td style="text-align:center;">
0.969
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.059)
</td>
<td style="text-align:center;">
(0.061)
</td>
<td style="text-align:center;">
(0.148)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
5.950
</td>
<td style="text-align:center;">
51.268
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(2.212)
</td>
<td style="text-align:center;">
(15.338)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq  mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.484
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.162)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.201
</td>
<td style="text-align:center;">
0.214
</td>
<td style="text-align:center;">
0.230
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.199
</td>
<td style="text-align:center;">
0.210
</td>
<td style="text-align:center;">
0.225
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
3757.2
</td>
<td style="text-align:center;">
3752.0
</td>
<td style="text-align:center;">
3745.1
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
3769.4
</td>
<td style="text-align:center;">
3768.3
</td>
<td style="text-align:center;">
3765.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
1875.608
</td>
<td style="text-align:center;">
1871.995
</td>
<td style="text-align:center;">
1867.543
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
108.643
</td>
<td style="text-align:center;">
58.724
</td>
<td style="text-align:center;">
42.839
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
18.27
</td>
<td style="text-align:center;">
18.14
</td>
<td style="text-align:center;">
17.97
</td>
</tr>
</tbody>
</table>
<p>Pretty good for a first pass! But let's clean things up a bit. For my taste, this table has far too many goodness of fit statistics. We can remove the ones that we don't want using the <code>gof_omit</code> option. To omit everything, set <code>gof_omit = '.*'</code>. Otherwise you can specify which measures to omit as follows:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="predictive-regression-part-ii.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(kids_regressions, <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|AIC|BIC&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS 1
</th>
<th style="text-align:center;">
OLS 2
</th>
<th style="text-align:center;">
OLS 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
25.800
</td>
<td style="text-align:center;">
25.732
</td>
<td style="text-align:center;">
11.482
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(5.917)
</td>
<td style="text-align:center;">
(5.875)
</td>
<td style="text-align:center;">
(13.758)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:center;">
0.610
</td>
<td style="text-align:center;">
0.564
</td>
<td style="text-align:center;">
0.969
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.059)
</td>
<td style="text-align:center;">
(0.061)
</td>
<td style="text-align:center;">
(0.148)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
5.950
</td>
<td style="text-align:center;">
51.268
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(2.212)
</td>
<td style="text-align:center;">
(15.338)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq  mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.484
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.162)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.201
</td>
<td style="text-align:center;">
0.214
</td>
<td style="text-align:center;">
0.230
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
108.643
</td>
<td style="text-align:center;">
58.724
</td>
<td style="text-align:center;">
42.839
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
18.27
</td>
<td style="text-align:center;">
18.14
</td>
<td style="text-align:center;">
17.97
</td>
</tr>
</tbody>
</table>
<p>That's much cleaner, but there's still room for improvement. With standard errors as large as 13 for some of the coefficient estimates in this table, it's silly if not downright innumerate to report three decimal places of precision in our estimates: differences on this scale are merely noise. The <code>fmt</code> option allows you to specify in <em>excruciating detail</em> how you would like the numbers in your table to be formatted. For full details, see <a href="https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html#fmt">this link</a>. The simplest use of this option is to set a desired number of decimal places, for example:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="predictive-regression-part-ii.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(kids_regressions, <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|AIC|BIC&#39;</span>,</span>
<span id="cb338-2"><a href="predictive-regression-part-ii.html#cb338-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="dv">2</span>, </span>
<span id="cb338-3"><a href="predictive-regression-part-ii.html#cb338-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">&#39;Regression results for kids dataset&#39;</span>,</span>
<span id="cb338-4"><a href="predictive-regression-part-ii.html#cb338-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">notes =</span> <span class="st">&#39;Source: all data were fabricated by the authors.&#39;</span>)</span></code></pre></div>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<caption>
<span id="tab:unnamed-chunk-196">Table 4.1: </span>Regression results for kids dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS 1
</th>
<th style="text-align:center;">
OLS 2
</th>
<th style="text-align:center;">
OLS 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
25.80
</td>
<td style="text-align:center;">
25.73
</td>
<td style="text-align:center;">
11.48
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(5.92)
</td>
<td style="text-align:center;">
(5.88)
</td>
<td style="text-align:center;">
(13.76)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq
</td>
<td style="text-align:center;">
0.61
</td>
<td style="text-align:center;">
0.56
</td>
<td style="text-align:center;">
0.97
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.06)
</td>
<td style="text-align:center;">
(0.06)
</td>
<td style="text-align:center;">
(0.15)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
5.95
</td>
<td style="text-align:center;">
51.27
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(2.21)
</td>
<td style="text-align:center;">
(15.34)
</td>
</tr>
<tr>
<td style="text-align:left;">
mom_iq  mom_hs
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.48
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.16)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.201
</td>
<td style="text-align:center;">
0.214
</td>
<td style="text-align:center;">
0.230
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
108.643
</td>
<td style="text-align:center;">
58.724
</td>
<td style="text-align:center;">
42.839
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
18.27
</td>
<td style="text-align:center;">
18.14
</td>
<td style="text-align:center;">
17.97
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Source: all data were fabricated by the authors.
</td>
</tr>
</tfoot>
</table>
<p>where I added in a title and footnote for good measure!</p>
</div>
<div id="robust-standard-errors" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Robust Standard Errors<a href="predictive-regression-part-ii.html#robust-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to display heteroskedasticity-robust standard errors in a table constructed with <code>modelsummary()</code> you have two options. The first, and simplest, is to pass it a model fitted with <code>lm_robust</code>. For example, using the simulated <code>x</code> and <code>y</code> data from above:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="predictive-regression-part-ii.html#cb339-1" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb339-2"><a href="predictive-regression-part-ii.html#cb339-2" aria-hidden="true" tabindex="-1"></a>robust <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(y <span class="sc">~</span> x)</span>
<span id="cb339-3"><a href="predictive-regression-part-ii.html#cb339-3" aria-hidden="true" tabindex="-1"></a>different_SEs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&#39;OLS&#39;</span> <span class="ot">=</span> ols, <span class="st">&#39;Robust&#39;</span> <span class="ot">=</span> robust)</span>
<span id="cb339-4"><a href="predictive-regression-part-ii.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">tidy</span>(ols)[, <span class="fu">c</span>(<span class="st">&#39;term&#39;</span>, <span class="st">&#39;std.error&#39;</span>)], </span>
<span id="cb339-5"><a href="predictive-regression-part-ii.html#cb339-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">robust =</span> <span class="fu">tidy</span>(robust)<span class="sc">$</span>std.error)</span></code></pre></div>
<pre><code>##          term  std.error     robust
## 1 (Intercept) 2.15350326 3.30916120
## 2           x 0.02129732 0.03591114</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="predictive-regression-part-ii.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(different_SEs, <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|R2|AIC|BIC|F|RMSE&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS
</th>
<th style="text-align:center;">
Robust
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
23.148
</td>
<td style="text-align:center;">
23.148
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(2.154)
</td>
<td style="text-align:center;">
(3.309)
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:center;">
0.641
</td>
<td style="text-align:center;">
0.641
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.021)
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.036)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
Std.Errors
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
HC2
</td>
</tr>
</tbody>
</table>
<p>Notice that <code>modelsummary()</code> very helpfully indicates which flavor of robust standard errors appear in the <code>Robust</code> column. The second option is to fit your model using <code>lm()</code> and have <code>modelsummary()</code> do the appropriate standard error calculations for you using the <code>vcov</code> option:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="predictive-regression-part-ii.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">vcov =</span> <span class="st">&#39;HC2&#39;</span>, <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|R2|AIC|BIC|F|RMSE&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
23.148
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(3.309)
</td>
</tr>
<tr>
<td style="text-align:left;">
x
</td>
<td style="text-align:center;">
0.641
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.036)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
434
</td>
</tr>
<tr>
<td style="text-align:left;">
Std.Errors
</td>
<td style="text-align:center;">
HC2
</td>
</tr>
</tbody>
</table>
<p>The heavily lifting in this case is done in the background by the <code>sandwich</code> package: see <a href="https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html#vcov">this link</a> for more details.</p>
</div>
<div id="exercise-30" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Exercise<a href="predictive-regression-part-ii.html#exercise-30" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Read the help file for the <code>tips</code> dataset, available in the <code>reshape2</code> package. Then use <code>datasummary_skim()</code> to make two tables of summary statistics for <code>tips</code>: one for the categorical variables and one for the remaining variables.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="predictive-regression-part-ii.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb343-2"><a href="predictive-regression-part-ii.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(tips)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Unique (#)
</th>
<th style="text-align:right;">
Missing (%)
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
Max
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
total_bill
</td>
<td style="text-align:right;">
229
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
19.8
</td>
<td style="text-align:right;">
8.9
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
50.8
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="-1.08" y="11.54" width="4.65" height="0.13" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="3.57" y="9.65" width="4.65" height="2.02" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="8.23" y="3.72" width="4.65" height="7.94" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="12.88" y="3.22" width="4.65" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="17.54" y="6.37" width="4.65" height="5.29" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="22.19" y="8.76" width="4.65" height="2.90" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="26.85" y="9.65" width="4.65" height="2.02" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="31.50" y="10.91" width="4.65" height="0.76" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="36.16" y="11.03" width="4.65" height="0.63" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="40.81" y="11.16" width="4.65" height="0.50" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="45.47" y="11.54" width="4.65" height="0.13" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
tip
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="3.22" width="4.94" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="6.72" y="4.30" width="4.94" height="7.36" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="11.65" y="5.49" width="4.94" height="6.17" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="16.59" y="9.17" width="4.94" height="2.49" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="21.53" y="10.47" width="4.94" height="1.19" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="26.47" y="11.23" width="4.94" height="0.43" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="31.41" y="11.55" width="4.94" height="0.11" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="36.35" y="11.55" width="4.94" height="0.11" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="41.28" y="11.55" width="4.94" height="0.11" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
<tr>
<td style="text-align:left;">
size
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="48.00pt" height="12.00pt" viewBox="0 0 48.00 12.00">
<defs>
<style type="text/css">
    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
    .svglite text {
      white-space: pre;
    }
  </style>
</defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clipPath id="cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw"><rect x="0.00" y="0.00" width="48.00" height="12.00"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwwLjAwfDEyLjAw)">
</g><defs><clipPath id="cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw"><rect x="0.00" y="2.88" width="48.00" height="9.12"></rect></clipPath></defs><g clip-path="url(#cpMC4wMHw0OC4wMHwyLjg4fDEyLjAw)"><rect x="1.78" y="11.45" width="4.44" height="0.22" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="6.22" y="3.22" width="4.44" height="8.44" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="10.67" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="15.11" y="9.61" width="4.44" height="2.06" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="19.56" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="24.00" y="9.66" width="4.44" height="2.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="28.44" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="32.89" y="11.39" width="4.44" height="0.27" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="37.33" y="11.66" width="4.44" height="0.00" style="stroke-width: 0.38; fill: #000000;"></rect><rect x="41.78" y="11.45" width="4.44" height="0.22" style="stroke-width: 0.38; fill: #000000;"></rect></g>
</svg>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="predictive-regression-part-ii.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(tips, <span class="at">type =</span> <span class="st">&#39;categorical&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
35.7
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
64.3
</td>
</tr>
<tr>
<td style="text-align:left;">
smoker
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
61.9
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
38.1
</td>
</tr>
<tr>
<td style="text-align:left;">
day
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
7.8
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
35.7
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
31.1
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
25.4
</td>
</tr>
<tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
72.1
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
27.9
</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Suppose you were curious to know whether any of the columns of <code>tips</code> vary with <code>sex</code>. Use <code>datasummary_balance()</code> to construct a table of summary statistics that would allow you to explore this possibility. Comment on the results.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="predictive-regression-part-ii.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_balance</span>(<span class="sc">~</span> sex, tips)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Female (N=87)
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Male (N=157)
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Std. Dev.
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Std. Dev.
</th>
<th style="text-align:right;">
Diff. in Means
</th>
<th style="text-align:right;">
Std. Error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
total_bill
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
8.0
</td>
<td style="text-align:right;">
20.7
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
1.1
</td>
</tr>
<tr>
<td style="text-align:left;">
tip
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
2.8
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
size
</td>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:right;box-shadow: 0px 1px">
2.5
</td>
<td style="text-align:right;box-shadow: 0px 1px">
0.9
</td>
<td style="text-align:right;box-shadow: 0px 1px">
2.6
</td>
<td style="text-align:right;box-shadow: 0px 1px">
1.0
</td>
<td style="text-align:right;box-shadow: 0px 1px">
0.2
</td>
<td style="text-align:right;box-shadow: 0px 1px">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
N
</td>
<td style="text-align:right;">
Pct.
</td>
<td style="text-align:right;">
N
</td>
<td style="text-align:right;">
Pct.
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
smoker
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
62.1
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
61.8
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
37.9
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
38.2
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
day
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10.3
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
6.4
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
32.2
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
37.6
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
20.7
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
36.9
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
36.8
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
19.1
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
59.8
</td>
<td style="text-align:right;">
124
</td>
<td style="text-align:right;">
79.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
40.2
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>Male bill payers appear to spend around $2.70 more overall, a difference that is fairly precisely estimated, but there's no clear difference in <code>tip</code> and only a small difference in party size. Male bill payers seem to be much more common at dinner compared to lunch.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Choose three regression specifications to predict <code>tip</code> using other columns in the <code>tips</code> dataset. Any three specifications are fine: you're free to choose! Use <code>modelsummary()</code> to create a table of regression output for these models using the default <code>lm()</code> standard errors.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="predictive-regression-part-ii.html#cb346-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> total_bill, tips)</span>
<span id="cb346-2"><a href="predictive-regression-part-ii.html#cb346-2" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> total_bill <span class="sc">+</span> size, tips)</span>
<span id="cb346-3"><a href="predictive-regression-part-ii.html#cb346-3" aria-hidden="true" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tip <span class="sc">~</span> total_bill <span class="sc">+</span> size <span class="sc">+</span> sex, tips)</span>
<span id="cb346-4"><a href="predictive-regression-part-ii.html#cb346-4" aria-hidden="true" tabindex="-1"></a>reg_results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&#39;OLS 1&#39;</span> <span class="ot">=</span> reg1,</span>
<span id="cb346-5"><a href="predictive-regression-part-ii.html#cb346-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;OLS 2&#39;</span> <span class="ot">=</span> reg2,</span>
<span id="cb346-6"><a href="predictive-regression-part-ii.html#cb346-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;OLS 3&#39;</span> <span class="ot">=</span> reg3)</span>
<span id="cb346-7"><a href="predictive-regression-part-ii.html#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(reg_results, </span>
<span id="cb346-8"><a href="predictive-regression-part-ii.html#cb346-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|AIC|BIC&#39;</span>,</span>
<span id="cb346-9"><a href="predictive-regression-part-ii.html#cb346-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="dv">2</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS 1
</th>
<th style="text-align:center;">
OLS 2
</th>
<th style="text-align:center;">
OLS 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
0.67
</td>
<td style="text-align:center;">
0.68
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.16)
</td>
<td style="text-align:center;">
(0.19)
</td>
<td style="text-align:center;">
(0.21)
</td>
</tr>
<tr>
<td style="text-align:left;">
total_bill
</td>
<td style="text-align:center;">
0.11
</td>
<td style="text-align:center;">
0.09
</td>
<td style="text-align:center;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.01)
</td>
<td style="text-align:center;">
(0.01)
</td>
<td style="text-align:center;">
(0.01)
</td>
</tr>
<tr>
<td style="text-align:left;">
size
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.19
</td>
<td style="text-align:center;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.09)
</td>
<td style="text-align:center;">
(0.09)
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.14)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
244
</td>
<td style="text-align:center;">
244
</td>
<td style="text-align:center;">
244
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.457
</td>
<td style="text-align:center;">
0.468
</td>
<td style="text-align:center;">
0.468
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
203.358
</td>
<td style="text-align:center;">
105.948
</td>
<td style="text-align:center;">
70.362
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:center;">
1.02
</td>
<td style="text-align:center;">
1.01
</td>
<td style="text-align:center;">
1.02
</td>
</tr>
</tbody>
</table>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Repeat the preceding with <code>HC2</code> standard errors.</li>
</ol>
<div class="webex-solution">
<button>
Show Solution
</button>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="predictive-regression-part-ii.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(reg_results, </span>
<span id="cb347-2"><a href="predictive-regression-part-ii.html#cb347-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">&#39;Log.Lik|R2 Adj.|AIC|BIC&#39;</span>,</span>
<span id="cb347-3"><a href="predictive-regression-part-ii.html#cb347-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb347-4"><a href="predictive-regression-part-ii.html#cb347-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">vcov =</span> <span class="st">&#39;HC2&#39;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OLS 1
</th>
<th style="text-align:center;">
OLS 2
</th>
<th style="text-align:center;">
OLS 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
0.67
</td>
<td style="text-align:center;">
0.68
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.21)
</td>
<td style="text-align:center;">
(0.21)
</td>
<td style="text-align:center;">
(0.22)
</td>
</tr>
<tr>
<td style="text-align:left;">
total_bill
</td>
<td style="text-align:center;">
0.11
</td>
<td style="text-align:center;">
0.09
</td>
<td style="text-align:center;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.01)
</td>
<td style="text-align:center;">
(0.02)
</td>
<td style="text-align:center;">
(0.02)
</td>
</tr>
<tr>
<td style="text-align:left;">
size
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.19
</td>
<td style="text-align:center;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.11)
</td>
<td style="text-align:center;">
(0.11)
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.12)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
244
</td>
<td style="text-align:center;">
244
</td>
<td style="text-align:center;">
244
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.457
</td>
<td style="text-align:center;">
0.468
</td>
<td style="text-align:center;">
0.468
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
77.546
</td>
<td style="text-align:center;">
51.918
</td>
<td style="text-align:center;">
35.076
</td>
</tr>
<tr>
<td style="text-align:left;">
Std.Errors
</td>
<td style="text-align:center;">
HC2
</td>
<td style="text-align:center;">
HC2
</td>
<td style="text-align:center;">
HC2
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>To make a long story short: it's almost never plausible that the null hypothesis holds <em>exactly</em>. If the null is even slightly incorrect then we're certain to reject it if we gather enough data, but this doesn't tell us anything of scientific interest. What really matters is <em>effect sizes</em> and the precision with which we can estimate them; not p-values.<a href="predictive-regression-part-ii.html#fnref11" class="footnote-back"></a></p></li>
<li id="fn12"><p>Recall that a Wald test compares the estimated coefficients from an unrestricted model to their hypothesized values under a specified restriction.<a href="predictive-regression-part-ii.html#fnref12" class="footnote-back"></a></p></li>
</ol>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="predictive-regression-part-i.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="running-a-simulation-study.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
